<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Workshop 3: Introduction to ggplot2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Québec Centre for Biodiversity Science" />
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <script src="assets/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="assets/plotly-binding-4.9.0/plotly.js"></script>
    <script src="assets/typedarray-0.1/typedarray.min.js"></script>
    <script src="assets/jquery-1.11.3/jquery.min.js"></script>
    <link href="assets/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="assets/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="assets/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="assets/plotly-main-1.46.1/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css">
    <link rel="stylesheet" href="qcbsR.css" type="text/css" />
    <link rel="stylesheet" href="qcbsR-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Workshop 3: Introduction to <code>ggplot2</code>
## QCBS R Workshop Series
### Québec Centre for Biodiversity Science

---












# Introduction

#### To follow along:

Code and .HTML available at http://qcbs.ca/wiki/r/workshop3

#### Recommendations:

  1. create your own new script;
  2. refer to provided code only if needed;
  3. avoid copy-pasting or running the code directly from the script.

###### [ggplot2](https://ggplot2.tidyverse.org/) is also on GitHub: https://github.com/tidyverse/ggplot2


---
# Outline

###### 1. `ggplot2` mechanics

&lt;div style="text-align:center"&gt;
&lt;img src="images/Layers_ggplot.png" width=55%&gt;
&lt;/div&gt;



###### 2. Advanced visualization

###### 3. Fine-tuning

###### 4. Saving plots

###### 5. Conclusion

---
# Learning objectives

&lt;br&gt;

- Teach the basics of data visualization using R.
- A good representation of one's data can be unique and thus no single function or package can meet everyone's needs.
- Creativity is important to scientists!
- A basic understanding of design to communicate effectively with graphs.

---
class: inverse, center, middle

# Visualization in science

---
# Visualization in science
&lt;br&gt;

#### Why are we using data visualization?

#### What makes an effective visualization?

&lt;br&gt;

.center[![:scale 65%](images/piechart3d.png)]

What do you thing about this one ![:faic](arrow-up)?

---
# Visualization in science
&lt;br&gt;

1. Represent results of statistical analyses
2. Research and discuss (preliminary data from the literature, summaries, formulate hypotheses)
3. Explore your own data (exploratory data analysis, outlier detection)
4. Communicate and report
  - Clearly (design principles)
  - Precisely and accurately
  - Effectively and efficiently

---
# Visualization in science
&lt;br&gt;

Important questions:
- What do you want to communicate?
- What is your public?
- What is the best way to do it?

.center[
.alert[A rule of thumb: think simple — use less ink!]
]




---
# WARNING!

&lt;br&gt;

.alert[
### &amp;#x26A0; `R` is not made for drawings.
]

Other drawing softwares are probably more interesting options such as [GIMP](https://www.gimp.org/) or [Inkscape](https://inkscape.org/). It is important to get the right tool for the right task!

---
## Why use R for plotting?

.center[![:scale 80%](images/Divided_reproducible workflow.png)]

---
# Why use R for plotting? Reproducibility

.center[![:scale 80%](images/Divided_reproducible workflow2.png)]


.alert[Reproducible science comes with effort]:
- comment the script
- add relevant information in the figures (titles, labels, captions)

---
# Why R for graphs?

#### .alert[ Because of its powerful features!]

In this workshop, we focus only on `ggplot2`, but [multiple packages and functions](https://insileco.github.io/wiki/rgraphpkgs/) can be used for great visualization (e.g., ["base R"](https://bookdown.org/rdpeng/exdata/the-base-plotting-system-1.html), [plotly](https://plot.ly/r/), [sjPlot](http://www.strengejacke.de/sjPlot/), [mapview](https://r-spatial.github.io/mapview/), [igraph](https://igraph.org/r/)).

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-3-1.png" width="648" style="display: block; margin: auto;" /&gt;


---
# `ggplot2` is versatile

1. [`ggplot2`](https://ggplot2.tidyverse.org/) package lets you make beautiful and customizable plots;
2. it implements the grammar of graphics, an easy to use system for building plots;
3. it [has many extensions](https://insileco.github.io/wiki/rgraphpkgs/#ggplot2andextensions).


.center[![:scale 35%](images/ggplot2_logo.png)]


---
class: inverse, center, middle

# `ggplot2` mechanics: the basics

---

# Grammar of Graphics (GG) basics


```r
install.packages("ggplot2") # if not already installed
library(ggplot2)
```



A graphic is made of different layers:

.center[
![:scale 90%](images/Layers_ggplot.png)
]

We will learn how to build graphs step by step to make it look as we desire.

---
# Grammar of Graphics (GG) basics

These layers have specific names that you will see throughout the presentation:

![](images/components_GG.png)

.small[image from [Towards Data Science](https://towardsdatascience.com/a-comprehensive-guide-to-the-grammar-of-graphics-for-effective-visualization-of-multi-dimensional-1f92b4ed4149)]

---
# Grammar of Graphics (GG) basics

.center[
![:scale 40%](images/ggplot_scale_geoms.png)
]


---
# Grammar of Graphics (GG) basics

Here are the basic requirements to draw the simplest ``ggplot`:

.center[
![:scale 80%](images/ggplot_basics.png)
]



---
# Grammar of Graphics (GG)

A graphic is made of elements (layers)

- Data
- Aesthetics (aes), to make data visible
    - `x`, `y`: position along the x and y axis
    - `colour`: the colour of the point
    - `group`: what group a point belongs to
    - `shape`: the figure used to plot a point
    - `linetype`: the type of line used (solid, dashed, etc)
    - `size`: the size of the point or line
    - `alpha`: the transparency of the point

---
# Grammar of Graphics (GG)

A graphic is made of elements (layers)

- Data
- Aesthetics (aes)
- Geometric objects (geoms)
    * `geom_point()`: scatterplot
    * `geom_line()`: lines connecting points by increasing value of x
    * `geom_path()`: lines connecting points in sequence of appearance
    * `geom_boxplot()`: box and whiskers plot for categorical variables
    * `geom_bar()`: bar charts for categorical x axis
    * `geom_histogram()`: histogram for continuous x axis

---
# How layer in ggplot works

1. Create a simple plot object:
  * `plot.object &lt;- ggplot()`

2. Add graphical layers:
  * `plot.object &lt;- plot.object + layer()`

3. Repeat step 2 until satisfied, then print:
  * `plot.object` or `print(plot.object)`

---
# Prepare data for `ggplot2` 

`ggplot2` requires you to prepare the data as an object of class `data.frame` or `tibble` (common in the `tidyverse`).


```r
library(tibble)
class(iris) # all set!
# [1] "data.frame"

ir &lt;- as_tibble(iris) # acceptable
class(ir)
# [1] "tbl_df"     "tbl"        "data.frame"
```

---
# iris dataset


```r
## ?iris
str(iris)
# 'data.frame':	150 obs. of  5 variables:
#  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
#  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
#  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
#  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
#  $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
```

.center[**Scientific questions**]
- Is there a relation between the **length** &amp; the **width** of the iris **Sepal** ?
- Is there a relation between the **length** &amp; the **width** of the iris **Pepal** ?
- Does the size of the **Petal &amp; Sepal** vary together ?
- How are these measures distributed among the **5 Iris species** ?

.center[.alert[How to graphically address these questions with ggplot ?]]

---
# Exploring data structure

&lt;!-- Explain the databases before the examples  --&gt;


```r
library(psych)
pairs.panels(iris)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-8-1.png" width="468" style="display: block; margin: auto;" /&gt;

---
# Exploring data structure

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-9-1.png" width="648" style="display: block; margin: auto;" /&gt;

.small[&amp;#x267B; See [*Loading and manipulating data workshop*](http://qcbs.ca/wiki/r_workshop2) to learn how to clean your dataset.]


---

# Inheritance in `ggplot2`

.small[

.pull-left[
**Inheritance from ggplot**

```r
p &lt;- ggplot(data = iris,
            aes(x = Sepal.Length,
                y = Sepal.Width))
p &lt;- p + geom_point()
p   
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-10-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[
**No inheritance from ggplot**

```r
s &lt;- ggplot()
s &lt;- s + geom_point(data = iris,
                    aes(x = Sepal.Length,
                        y = Sepal.Width))
s # Print your final plot
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-11-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

]

---
# Grammar of Graphics: *recall*

&lt;br&gt;

Remember: a graphic is made of different layers:

![](images/Layers_ggplot.png)

---
# `ggplot()` dynamics: base layer


```r
ggplot()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-12-1.png" width="360" style="display: block; margin: auto;" /&gt;

---
# `ggplot()` dynamics: data layer


```r
ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  xlab("x = Sepal length") +
  ylab("y = Sepal width")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-13-1.png" width="360" style="display: block; margin: auto;" /&gt;

---

# `ggplot()` dynamics: geometric Layer


```r
ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  xlab("x = Sepal length") +
  ylab("y = Sepal width") +
  geom_point()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-14-1.png" width="360" style="display: block; margin: auto;" /&gt;

---
# Challenge #1 (5min) ![:cube]()

#### Draw your 1st ggplot!

.alert[Question]

&gt; Is there a relation between the **length** &amp; the **width** of the iris **petal** ?

&gt; Does the *width* of the petal increase with its *length* ?

.center[Parameters to consider when addressing this question:]

 data | geom | x value | y value
:-------------:|:-------------:|:-------------:|:-------------:
iris|geom_point|Petal length|Petal width


---
# Challenge 1#: Solution ![:cube]()


```r
ggplot(data = iris, aes(x = Petal.Length, 
                        y = Petal.Width)) +
  geom_point()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-15-1.png" width="360" style="display: block; margin: auto;" /&gt;

---

class: inverse, center, middle

# Aesthetic mapping

## colour, shape, size, labels and transparency

---

# Aesthetic

##### Use aesthetics (`aes()`) to distinguish classes, groups and structure


&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;" /&gt;

---

# Colouring: make your points talk

Change **colour** to

&amp;nbsp; ![:faic](arrow-right) differentiate between groups

&amp;nbsp; ![:faic](arrow-right) represent data values

&amp;nbsp; ![:faic](arrow-right) highlight specific elements

.pull-left[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-17-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-18-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.small[See [Fundamentals of Data Visualization](https://serialmentor.com/dataviz/colour-basics.html)]

---

# Using `aes()` use to change colour

* Do the sepal length and width vary differently across species?


```r
# No colour mapping
ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width)) +
  labs(title = "No colour mapping")
# With colour mapping
ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width, colour = Species)) +
  labs(title = "With colour mapping")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-19-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-19-2.png" width="50%" /&gt;

---
# Change colour manually


```r
# Default
pp &lt;- ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width, colour = Species))
pp + labs(title = "Default")
# Manual
pp +
  scale_colour_manual(values = c("grey55", "orange", "skyblue")) +
  labs(title = "Manual")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-20-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-20-2.png" width="50%" /&gt;


---
# Colour gradient


```r
# Default
pp2 &lt;- ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width, 
                           colour = Petal.Length))
pp2 + labs(title = "Default")
# Manual
pp2 + scale_colour_gradient(low = "blue", high = "red") +
  labs(title = "Manual")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-21-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-21-2.png" width="50%" /&gt;

---
# Use a predefined colour palette


```r
install.packages("RColorBrewer")
require(RColorBrewer)
display.brewer.all()
```

![:scale 100%](images/rcolorbrewer_palette.png)


---
# Use a predefined colour palette


```r
# Palette for groups
pp + scale_colour_brewer(palette = "Dark2") +
  labs(title = "Palette for groups")
# Palette for continuous values
pp2 + scale_colour_gradientn(colours = rainbow(5)) +
  labs(title = "Palette for continuous values")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-23-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-23-2.png" width="50%" /&gt;


---
# Use a predefined colour palette

Grey-scale palette for publication purposes


```r
# Palette for groups
pp + scale_colour_grey() +
  labs(title = "Palette for groups")
# Palette for continuous values
pp2 + scale_colour_gradient(low = "grey85", high = "black") +
  labs(title = "Palette for continuous values")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-24-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-24-2.png" width="50%" /&gt;


---
# Use colourblind-friendly palettes

How your figure might appear under various forms of colourblindness?

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-25-1.png" width="720" style="display: block; margin: auto;" /&gt;

---
# Use colourblind-friendly palettes


```r
# Palette for groups
pp + scale_colour_viridis_d() +
  labs(title = "viridis palette for groups")
# Palette for continuous values
pp2 + scale_colour_viridis_c() +
  labs(title = "viridis palette for continuous values")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-26-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-26-2.png" width="50%" /&gt;


---
# Changing `shape`, `size` and `alpha`


```r
# shape for groups
ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width, shape = Species)) +
  labs(title = "shape for groups")

# size and alpha for continuous values
ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width,
                           size = Petal.Length, alpha = Petal.Length)) +
  labs(title = "size and alpha for continuous values")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-27-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-27-2.png" width="50%" /&gt;


---
# Challenge #2 ![:cube]()

- Produce an informative plot from built-in datasets such as `mtcars`, `CO2` or `msleep`.

- Use appropriate aesthetic mappings for different data types


&lt;br&gt;

Data| x | y | Aesthetics
:-------------:|:-------------:|:-------------:|:-------------:
mtcars |*wt* |*mpg* | *disp* and *hp*
CO2 |*conc* |*uptake* | *Treatment* and *Type*
msleep |log10(*bodywt*) |*awake* | *vore* and *conservation*

&lt;br&gt;
.center[.alert[
![:faic](exclamation-triangle) Pay attention to the data types!
]
]
---
# Challenge #2 - Solution example #1


```r
data(mtcars)
ggplot(data = mtcars) +
  geom_point(mapping = aes(x = wt, y = mpg,
                           colour = disp, 
                           alpha = hp))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-28-1.png" width="446.4" style="display: block; margin: auto;" /&gt;

.comment[Could you use `size` intead of `alpha`? What about `shape`?]

---
# Challenge #2 - Solution example #2


```r
data(CO2)
ggplot(data = CO2) +
    geom_point(mapping = aes(x = conc, y = uptake,
                             colour = Treatment, shape = Type))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-29-1.png" width="446.4" style="display: block; margin: auto;" /&gt;

.comment[Why not use `size = Type`?]

---
# Challenge #2 - Solution example #3


```r
data(msleep)
ggplot(data = msleep) +
    geom_point(mapping = aes(x = log10(bodywt), y = awake,
                             colour = vore, shape = conservation))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-30-1.png" width="446.4" style="display: block; margin: auto;" /&gt;

.comment[Why not use `size = Type`?]

---
# Changing the scale of the axes
.small[

```r
# x axis in regular scale
ggplot(diamonds) + 
  geom_point(mapping = aes(x = carat, y = price)) +
  labs(title = "x-axis in regular scale")

# x-axis and y-axis in log10() scale
ggplot(diamonds) + geom_point(mapping = aes(x = carat, y = price)) +
  scale_x_log10() + 
  scale_y_log10() + 
  labs(title = "x- and y-axes in log10 scale")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-31-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-31-2.png" width="50%" /&gt;
]

.small[It is also possible to transform the coordinate system using `coord_trans(x = "log10", y = "log10")`]

&lt;!-- explain the difference --&gt;

---
class: inverse, center, middle

# Fine-tuning your plots

## Using `theme()` to make it look good!

---
# `theme()`


```r
# Theme classic
pp + scale_colour_grey() + 
  theme_classic() +
  labs(title = "Classic")

# Theme minimal
pp + scale_colour_grey() + 
  theme_minimal() +
  labs(title = "Minimal")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-32-1.png" width="50%" /&gt;&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-32-2.png" width="50%" /&gt;

NB: Good choices for publication purposes!

---
## ggThemeAssist: RStudio-addin

![](https://raw.githubusercontent.com/calligross/ggthemeassist/master/examples/ggThemeAssist2.gif)

---
class: inverse, center, middle

# Fine-tuning your plots

## Using `facet_grid()` to change the arrangement of plots

---
# iris dataset: per-species facets

```r
ggplot(data = iris) +
  geom_point(mapping = aes(x = Sepal.Length, y = Sepal.Width, colour = Species)) +
  facet_grid(~ Species, scales = "free")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-33-1.png" width="720" style="display: block; margin: auto;" /&gt;

---
# CO2 dataset: per-type facets

```r
ggplot(data = CO2) +
  geom_point(mapping = aes(x = conc, y = uptake, colour = Treatment)) +
  xlab("CO2 Concentration (mL/L)") + ylab("CO2 Uptake (umol/m^2 sec)") + 
  facet_grid(~ Type)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-34-1.png" width="720" style="display: block; margin: auto;" /&gt;

&lt;!-- relabeling ticks --&gt;

---
# Title and axes components: changing size, colour and face

.center[![:scale 80%](images/theme_iris_annotated.png)]


---
# Title and axes components: size, colour and face

.pull-left[
**Default**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-35-1.png" width="432" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Axes and title tuning**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-36-1.png" width="432" style="display: block; margin: auto;" /&gt;

]

---

# Challenge #3 ![:cube]()

Use the `tips` dataset found in `reshape2` &amp;#x1F4E6; to reproduce the plot below.

Our tip: start from `theme_classic()` and add `theme()` to make your additional changes.

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-37-1.png" width="720" style="display: block; margin: auto;" /&gt;

---

# Challenge #3: Solution![:cube]()


```r
library(reshape2)
tips.gg &lt;- ggplot(tips, aes(x = total_bill,
                            y = tip/total_bill,
                            shape = smoker,
                            colour = sex,
                            size = size)) +
  geom_point() +
  facet_grid( ~ time) +
  scale_colour_grey() +
  labs(title = "Relation between total bill and tips during lunch and dinner",
       x = "Total bill ($)", y = "Ratio between tips and total bill") +
  theme_classic() +
  theme(axis.title = element_text(size = 16,
                                  colour = "navy"),
        axis.text = element_text(size = 12),
        plot.title = element_text(size = 16,
                                  colour = "orange3",
                                  face = "bold"),
        strip.text.x = element_text(size = 14, face="bold"))
tips.gg
```

---

# Challenge #3: step-by-step solution

#### `aes()`


```r
tips.gg &lt;- ggplot(tips) +
  geom_point(mapping = aes(x = total_bill, y = tip/total_bill,
                      shape = smoker, colour = sex, size = size))
tips.gg
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-39-1.png" width="504" style="display: block; margin: auto;" /&gt;


---
# Challenge #3: step-by-step solution

#### `facet_grid()`


```r
tips.gg &lt;- tips.gg +
  facet_grid( ~ time)
tips.gg
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-40-1.png" width="504" style="display: block; margin: auto;" /&gt;


---
# Challenge #3: step-by-step solution

#### Grey-scale palette


```r
tips.gg &lt;- tips.gg +
  scale_colour_grey()
tips.gg
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-41-1.png" width="504" style="display: block; margin: auto;" /&gt;

---
# Challenge #3: step-by-step solution

#### Adding plot title and labels


```r
tips.gg &lt;- tips.gg +
  labs(title = "Relation between total bill and tips during lunch and dinner",
       x = "Total bill ($)", y = "Ratio between tips and total bill")
tips.gg
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-42-1.png" width="504" style="display: block; margin: auto;" /&gt;

---

# Challenge #3: step-by-step solution

#### Adding a theme and fine tuning it

.small[

```r
tips.gg &lt;- tips.gg +
  theme_classic() +
  theme(axis.title = element_text(size = 16, colour = "navy"),
        axis.text = element_text(size = 12),
        plot.title = element_text(size = 16, colour = "orange3", face = "bold"),
        strip.text.x = element_text(size = 14, face = "bold"))
tips.gg
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-43-1.png" width="432" style="display: block; margin: auto;" /&gt;
]

---

# `ggplot2::geom_*()`

.center[
![:scale 85%](images/plots_in_various_contexts.png)
]

---

# `base::plot()`

.center[
![:scale 85%](images/plots_in_various_contexts_baseplot.png)
]


---

## `ggplot2::ggplot()` *versus* `base::plot()`
.pull-left[

```r
ggplot(mtcars, aes(wt, mpg))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-45-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
plot(mpg~wt, data = mtcars, type = "n")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-46-1.png" width="432" style="display: block; margin: auto;" /&gt;
]

---

# Histograms: `geom_histogram()`
.small[
A **histogram** is an accurate graphical representation of the distribution of numeric data
.pull-left[

```r
ggplot(iris, aes(Sepal.Length)) +
  geom_histogram() + 
  ggtitle("Histogram of sepal length ")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-47-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
.pull-right[

```r
ggplot(cars, aes(dist)) +
  geom_histogram() + 
  ggtitle("Histogram of distance done before stopping")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-48-1.png" width="360" style="display: block; margin: auto;" /&gt;
]]

---

# `geom_histogram()` *versus* `graphics::hist()`
.small[
.pull-left[

```r
ggplot(diamonds, aes(carat)) + 
  geom_histogram()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-50-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
.pull-right[

```r
hist(diamonds$carat)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-51-1.png" width="360" style="display: block; margin: auto;" /&gt;
]]

---

#### #Barplot: `geom_bar()` *versus* `graphics::barplot()`

.pull-left[

```r
ggplot(mpg, aes(class)) + 
  geom_bar()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-53-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
barplot(table(mpg$class))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-54-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

#### Annotating significant differences: `geom_signif()`
.pull-left[

```r
ggplot(mpg, aes(class)) +
  geom_bar() +
  geom_signif()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-56-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
barplot()
sign.bar()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-58-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

##### Scatterplot and linear-fit: `geom_point()` and `geom_smooth()`

.pull-left[

```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  geom_smooth(method = lm)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-60-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
lm.out  &lt;- lm(hwy ~ displ, data = mpg)
plot(hwy ~ displ, data = mpg)
abline(lm.out)

```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-62-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

# Boxplot: `geom_boxplot()`

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-63-1.png" width="216" style="display: block; margin: auto;" /&gt;

.center[
![:scale 75%](images/boxplot_explain.png)
]

---

##### Boxplot with annotations: `geom_boxplot()` and `geom_signif()`

.pull-left[

```r
ggplot(data = iris, aes(Species, Sepal.Length)) +
  geom_boxplot() +
  geom_signif()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-65-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
boxplot(iris$Sepal.Length ~ iris$Species)

```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-67-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

# Violin plot: `geom_violin()`

As explained on https://www.data-to-viz.com/graph/violin.html

&gt; Violin plot allows to visualize the distribution of a numeric variable for one or several groups. [...] It is really close to a boxplot, but allows a deeper understanding of the distribution.

.pull-left[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-68-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-69-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---
# Violin plot: `geom_violin()`
.small[
.pull-left[

```r
ggplot(data = iris, aes(Species,
                        Sepal.Length)) +
  geom_violin()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-71-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
.pull-right[

```r
library(vioplot)
vioplot(iris$Sepal.Length[iris$Species == "setosa"],
        iris$Sepal.Length[iris$Species == "versicolor"],
        iris$Sepal.Length[iris$Species == "virginica"],
        col = "lightblue")
```


```
# [1] 4.3 7.9
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-73-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
]

---

### Error bars: `geom_pointrange()` and `geom_errorbar()`

.pull-left[

```r
ggplot(df, aes(trt, resp, colour = group)) +
  geom_pointrange()+
  geom_errorbar() +
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-75-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
plot(y ~ x)
error.bar &lt;- function(...)
error.bar(x, y)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-77-1.png" width="360" style="display: block; margin: auto;" /&gt;

]

---

# Representing maps: `geom_map()`
.small[
.pull-left[

```r
library(maps)
states_map &lt;- map_data("state")
ggplot(crimes, 
       aes(map_id = state)) +
  geom_map() + 
  coord_map()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-79-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
library(rworldmap)
library(mapproj)
newmap &lt;- rworldmap::getMap(resolution = "low")
plot(newmap)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-81-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
]
---

# Density plots: `geom_density()`

.small[A density plot shows the distribution of a numerical variable and it takes only set of numeric values as input.]
.pull-left[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-82-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-83-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---
# Density plots: `geom_density()`

.pull-left[

```r
ggplot(diamonds, aes(carat)) +
  geom_density()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-85-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
plot(density(c(-20, 
               rep(0, 98), 20)),
     xlim = c(-4, 4))
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-87-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

# Dendogram: `ggdendrogram()`
.small[
.pull-left[

```r
library(ggdendro)
ggdendrogram() + 
  theme_classic()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-89-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

.pull-right[

```r
par(mar=c(3,3,4,4))
plot(as.dendrogram(hc), horiz = TRUE,
     main = "Dendrogram")
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-91-1.png" width="360" style="display: block; margin: auto;" /&gt;
]
]

---

# Multiplot

**A function to add multiple graphs on the same plot**


```r
plot.new()
#multiplot(density.gg, map.gg, violP.gg, lm.gg, cols = 2)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-92-1.png" width="360" style="display: block; margin: auto;" /&gt;

---

# Final Challenge ![:cube]()
  * Dataset: any (recommended: use your dataset)

```r
data(msleep) ; data(mtcars) ; data(OrchardSprays)
```



---

.small[

```r
msleep.challenge4 &lt;- ggplot(msleep, aes(vore, log10(brainwt), fill=vore))
msleep.challenge4 &lt;- msleep.challenge4 + geom_violin()
msleep.challenge4 &lt;- msleep.challenge4 + geom_signif(comparisons = list(c("herbi", "insecti")))
msleep.challenge4 &lt;- msleep.challenge4 + ggtitle("Brain weight among different vore")
msleep.challenge4 &lt;- msleep.challenge4 + ylab("Brain weight (log10(Kg))")
msleep.challenge4 &lt;- msleep.challenge4 + scale_fill_grey()
msleep.challenge4 &lt;- msleep.challenge4 + theme_classic()
msleep.challenge4 &lt;- msleep.challenge4 + theme(axis.title.x = element_text(size = 16),
                                               axis.title.y = element_text(size = 16),
                                               axis.text.x = element_text(size = 12),
                                               axis.text.y = element_text(size = 12),
                                               plot.title = element_text(size = 16, face="bold"),
                                               legend.title = element_text(size=14, face="bold"),
                                               legend.text = element_text(size=12))

```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-96-1.png" width="432" style="display: block; margin: auto;" /&gt;
]

---

.small[

```r
brain_body.challenge4 &lt;- ggplot(msleep, aes(log10(bodywt), log10(brainwt)))
brain_body.challenge4 &lt;- brain_body.challenge4 + geom_point()
brain_body.challenge4 &lt;- brain_body.challenge4 + geom_smooth(method = lm)
brain_body.challenge4 &lt;- brain_body.challenge4 + ggtitle("Linear regression on bodywt ~ brainwt")
brain_body.challenge4 &lt;- brain_body.challenge4 + ylab("Brain weight log10(Kg)") + xlab("Body weight log10(Kg)")
brain_body.challenge4 &lt;- brain_body.challenge4 + theme(axis.title.x = element_text(size = 16),
                                                       axis.title.y = element_text(size = 16),
                                                       axis.text.x = element_text(size = 12),
                                                       axis.text.y = element_text(size = 12),
                                                       plot.title = element_text(size = 14, face="bold"),
                                                       legend.title = element_text(size=14, face="bold"),
                                                       legend.text = element_text(size=12))

```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-98-1.png" width="432" style="display: block; margin: auto;" /&gt;

]

---

.small[

```r
mtcars.short &lt;- mtcars[1:20,]
mtcars.short.hc &lt;- hclust(dist(mtcars.short), "complete")
dendro.challenge4 &lt;- ggdendrogram(mtcars.short.hc, rotate = TRUE, theme_dendro = FALSE)
dendro.challenge4 &lt;- dendro.challenge4 + ggtitle("Car dendro from motor spec")
dendro.challenge4 &lt;- dendro.challenge4 + xlab("Cars")
dendro.challenge4 &lt;- dendro.challenge4 + theme(axis.title.y = element_text(size = 16),
                                               axis.title.x = element_blank(),
                                               axis.text.x = element_blank(),
                                               axis.text.y = element_text(size = 12),
                                               plot.title = element_text(size = 14, face="bold"))
dendro.challenge4
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-99-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

.small[

```r
Orchard.challenge4 &lt;- ggplot(data = OrchardSprays, aes(x=treatment, y=decrease)) + geom_boxplot()
Orchard.challenge4 &lt;- Orchard.challenge4 + ggtitle("Decrease of Orchad bees with different treatments")
Orchard.challenge4 &lt;- Orchard.challenge4 + ylab("Orchad bees decrese")
Orchard.challenge4 &lt;- Orchard.challenge4 + theme(axis.title.y = element_text(size = 14),
                                                 axis.title.x = element_text(size = 14),
                                                 axis.text.x = element_text(size = 12),
                                                 axis.text.y = element_text(size = 12),
                                                 plot.title = element_text(size = 14, face="bold"))
Orchard.challenge4
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-100-1.png" width="360" style="display: block; margin: auto;" /&gt;
]

---

# Solution to final challenge


```r
#multiplot(msleep.challenge4,dendro.challenge4, brain_body.challenge4, Orchard.challenge4, cols = 2)
```

---
# Miscellaneous: interactive plots
&lt;br&gt;

.alert[**Select the Species data to display directly From the legend**]
<div id="htmlwidget-6c1da19780b92f277b7c" style="width:792px;height:540px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c1da19780b92f277b7c">{"x":{"data":[{"x":[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5],"y":[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3],"text":["Sepal.Length: 5.1<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.7<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.6<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.9<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.4<br />Sepal.Width: 2.9<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.7<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.3<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.8<br />Sepal.Width: 4.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.7<br />Sepal.Width: 4.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.9<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.7<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.7<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.6<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.3<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.2<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.2<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.7<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.2<br />Sepal.Width: 4.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.5<br />Sepal.Width: 4.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.5<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.6<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.4<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.5<br />Sepal.Width: 2.3<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.4<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.3<br />Sepal.Width: 3.7<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.3<br />Species: setosa<br />Species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.6,"size":22.6771653543307,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7],"y":[3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8],"text":["Sepal.Length: 7.0<br />Sepal.Width: 3.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.4<br />Sepal.Width: 3.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.9<br />Sepal.Width: 3.1<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.5<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.3<br />Sepal.Width: 3.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 4.9<br />Sepal.Width: 2.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.6<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.2<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.0<br />Sepal.Width: 2.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.9<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 2.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.7<br />Sepal.Width: 3.1<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.2<br />Sepal.Width: 2.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.9<br />Sepal.Width: 3.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.3<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.4<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.6<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.8<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.7<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.6<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.4<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 3.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.7<br />Sepal.Width: 3.1<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.3<br />Sepal.Width: 2.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.6<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.8<br />Sepal.Width: 2.6<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.0<br />Sepal.Width: 2.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.2<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.1<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":0.6,"size":22.6771653543307,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"y":[3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],"text":["Sepal.Length: 6.3<br />Sepal.Width: 3.3<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.1<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.9<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.6<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 4.9<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.3<br />Sepal.Width: 2.9<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.2<br />Sepal.Width: 3.6<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.8<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.7<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.8<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 3.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 2.6<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.0<br />Sepal.Width: 2.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.9<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.6<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.3<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.2<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.2<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.1<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.2<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.4<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.9<br />Sepal.Width: 3.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.1<br />Sepal.Width: 2.6<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 3.4<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.0<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.9<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.9<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.8<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.3<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.2<br />Sepal.Width: 3.4<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.9<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":0.6,"size":22.6771653543307,"symbol":"square","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.689497716895,"r":7.97011207970112,"b":44.3669572436696,"l":47.0236612702366},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.12,8.08],"tickmode":"array","ticktext":["5","6","7","8"],"tickvals":[5,6,7,8],"categoryorder":"array","categoryarray":["5","6","7","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.98505603985056,"tickwidth":0.724555643609193,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.724555643609193,"zeroline":false,"anchor":"y","title":{"text":"Sepal.Length","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.88,4.52],"tickmode":"array","ticktext":["2.0","2.5","3.0","3.5","4.0","4.5"],"tickvals":[2,2.5,3,3.5,4,4.5],"categoryorder":"array","categoryarray":["2.0","2.5","3.0","3.5","4.0","4.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.98505603985056,"tickwidth":0.724555643609193,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.724555643609193,"zeroline":false,"anchor":"x","title":{"text":"Sepal.Width","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":2.06156048675734,"font":{"color":"rgba(0,0,0,1)","family":"","size":12.7521793275218},"y":0.979002624671916},"annotations":[{"text":"Species","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"2a734d8c2238":{"x":{},"y":{},"colour":{},"shape":{},"type":"scatter"}},"cur_data":"2a734d8c2238","visdat":{"2a734d8c2238":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---
class: inverse, center, middle

# Saving your plots with ggplot2

---

# Saving plots in RStudio

&lt;div style="text-align:center"&gt;
&lt;img src="images/save_image.png" height=70% width=70%&gt;
&lt;/div&gt;

.alert[Think about the margin of the document you are using. If you resize the image after saving it, the labels and text will change size as well which could be hard to read.]

---
# Saving plots in code

`ggsave()` writes directly to your working directory and allows you to specify the name of the file, the dimensions of the plot, the resolution, etc.


```r
my1rstPlot &lt;- ggplot(data = iris,
                     aes(x = Petal.Length,
                         y = Petal.Width)) +
  geom_point()
ggsave("my1stPlot.pdf",
       my1rstPlot,
       height = 8.5, width = 11, units = "in", res = 300)
```

NB: Vectors (e.g., pdf, svg) format are more flexible than raster format (jpeg,
png, ...) if the image needs modification afterwards.

---
# Saving plots in code
&lt;br&gt;

Other methods to save image: see `?pdf` `?jpeg`


```r
pdf("./graph_du_jour.pdf")
  print(my1rstPlot) # print function is necessary
graphics.off()
```





---
class: inverse, center, middle

# Going further


---
# Available elements


[Data Visualization with ggplot2 Cheat Sheet](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)

.center[![:scale 55%](images/available_geom.png)]

https://www.rstudio.com/resources/cheatsheets

---
# Additional resources

* `help(package = ggplot2)`
* http://ggplot2.tidyverse.org/reference/
* Fundamentals of Data Visualization https://serialmentor.com/dataviz/

.center[![:scale 65%](images/ggplot_book.png)]

---
# Concluding remarks
&lt;br&gt;

1. There are other useful packages that can be used with `ggplot2`! To name a few: `ggbio`, `ggpmisc`, `geomnet`, `gganimate`, `ggnetwork` and `ggtree`. Have a look at [www.ggplot2-exts.org](https://www.ggplot2-exts.org/) for other `ggplot2` extensions.


2. Note that you can learn more about design and image manipulation with the "Introduction to graphic design and image manipulation with open source tools": https://qcbs.ca/wiki/graphics



---
class: inverse, center, bottom

# Thank you for attending!

![:scale 50%](images/QCBS_logo.png)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="qcbsR-macros.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
