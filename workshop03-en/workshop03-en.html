<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Workshop 3: Introduction to ggplot2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Québec Centre for Biodiversity Science" />
    <link href="assets/remark-css-0.0.1/default.css" rel="stylesheet" />
    <script src="assets/htmlwidgets-1.3/htmlwidgets.js"></script>
    <script src="assets/plotly-binding-4.9.0/plotly.js"></script>
    <script src="assets/typedarray-0.1/typedarray.min.js"></script>
    <script src="assets/jquery-1.11.3/jquery.min.js"></script>
    <link href="assets/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="assets/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="assets/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="assets/plotly-main-1.46.1/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="assets/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/academicons-1.8.1/css/academicons.min.css">
    <link rel="stylesheet" href="qcbsR.css" type="text/css" />
    <link rel="stylesheet" href="qcbsR-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Workshop 3: Introduction to ggplot2
## QCBS R Workshop Series
### Québec Centre for Biodiversity Science

---








# Introduction

- To follow along:

Code and .HTML available at http://qcbs.ca/wiki/r/workshop3

- Recommendation:
      * create your own new script
      * refer to provided code only if needed
      * avoid copy pasting or running the code directly from script

- ggplot2 is also hosted on Github: https://github.com/hadley/ggplot2

---
# Outline
1. ggplot mechanics
&lt;div style="text-align:center"&gt;
&lt;img src="images/Layers_ggplot.png" height=40% width=40%&gt;
&lt;/div&gt;

2. Advanced visualization 
  * point, line, Histogram, box plot
  * Error bar, significant value &amp; linear regression

3. Fine-tuning
&lt;div style="text-align:center"&gt;
&lt;img src="images/ggplot functions geoms (cheatsheet) scale.png" height=10% width=10%&gt;
&lt;/div&gt;

4. Saving plots

5. Conclusion

---
# Learning objectives

- Our aim is to teach the basics of visualization of data using R 
- Keep in mind that representing your science visually might be unique and that no single function or package might solve your data vizualisation problems
- Creativity is important for scientists! 
- A basic understanding of design to communicate effectively with graphs 

---
class: inverse, center, middle

# Visualization in science

---
## Visualization in science

Why are we using data visualization? 

What makes an effective visualization? 


&lt;!-- maybe worse to pinpoint all ugly stuff on the graph  --&gt;

---
## Visualization in science

1. Represent data analyses with statistical analysis 
2. Research and discuss (preliminary data from the literature, summaries, formulate hypotheses)
3. Explore your own data (exploratory data analysis, outlier detection)
4. Communicate and report 
  - Clearly (design principles)
  - Precisely and accurately 
  - Effectively and efficiently 

Important questions: 
- What do you want to communicate? 
- To who? 
- How to do it? (data type, data preparation)

&lt;div style="text-align:center"&gt;
A rule of thumb: think simple — use less ink! 
&lt;/div&gt;


---
## WARNING! 
&lt;div style="text-align:center"&gt;
&lt;img src="images/warning sign.png" height=25% width=25%&gt;
&lt;/div&gt;

R is not made for drawings. Other drawing softwares are probably more interesting options such as GIMP or Inkscape. It is important to get the right tool for the right task! 

&lt;div style="text-align:center"&gt;
&lt;img src="images/inkscape_owler.png" height=35% width=35%&gt;
&lt;img src="images/The_GIMP.png" height=25% width=25%&gt;
&lt;/div&gt;

---
## Why use R for plotting?
&lt;div style="text-align:center"&gt;
&lt;img src="images/Divided_reproducible workflow.png" height=85% width=85%&gt;
&lt;/div&gt;

---
## Why use R for plotting? Reproducibility
&lt;div style="text-align:center"&gt;
&lt;img src="images/Divided_reproducible workflow2.png" height=85% width=85%&gt;
&lt;/div&gt;

Be careful: reproducible science comes with effort: 
- comment the script 
- add relevnt information in the figures (titles, lables, captions)

---
## Why R for graphs? Beautiful and flexible

Multiple packages and functions that help achieve great visualization ("base R", lattice, plotly, rgl, plot3d, maps, etc.). We focus only on `ggplot2`. Here is an example: 

&lt;div style="text-align:center"&gt;
&lt;img src="images/graph.png" height=65% width=65%&gt;
&lt;/div&gt;





---
## ggplot2 is versatile

The `ggplot2` package lets you make beautiful and customizable plots of your data. It implements the grammar of graphics, an easy to use system for building plots. But it is usually slower to graph and has a different way of writing the functions: the grammar of graphics. 

&lt;div style="text-align:center"&gt;
&lt;img src="images/ggplot2_logo.png" height=40% width=40%&gt;
&lt;/div&gt;

---
class: inverse, center, middle

# ggplot mechanics: the basics

---

## Grammar of Graphics (GG) basics

Required packages

```r
install.packages("ggplot2")
library(ggplot2)
```

A graphic is made of different layers:

&lt;div style="text-align:center"&gt;
&lt;img src="images/Layers_ggplot.png" height=90% width=90%&gt;
&lt;/div&gt;

We will learn how to build graphs iteratively to make it look like we want. 

---
## Grammar of Graphics (GG) basics
These layers have specific names that you will see throughout the presentation: 

Element | Description
:-------------:|:-------------:
aesthetics (`aes`) | what you want to "see", or the data mapped to aesthetics
geometries (`geoms`) | how you want to "see" it
coordinate system | the axis (cartesian, log, flipped)
stats | transform the raw data (~similar to geoms)
scales | fine-tune how "aes" is represented
labels, legends, themes, zoom, and facets (panels) | Other modifications

&lt;div style="text-align:center"&gt;
&lt;img src="images/ggplot functions geoms (cheatsheet).png" height=80% width=80%&gt;
&lt;/div&gt;

---
## Grammar of Graphics (GG) basics
But here are the basic requirements to draw the simplest ggplot: 

&lt;div style="text-align:center"&gt;
&lt;img src="images/ggplot basics.png" height=80% width=80%&gt;
&lt;/div&gt;

---
## Grammar of Graphics (GG)
A graphic is made of elements (layers)

- Data
- Aesthetics (aes), to make data visible
    * *x,y*: position along the x and y axis
    * *colour*: the colour of the point
    * *group*: what group a point belongs to
    * *shape*: the figure used to plot a point
    * *linetype*: the type of line used (solid, dashed, etc)
    * *size*: the size of the point or line
    * *alpha*: the transparency of the point

---
## Grammar of Graphics (GG)
A graphic is made of elements (layers)

- Data
- Aesthetics (aes)
- Geometric objects (geoms)
    * `geom_point()`: scatterplot
    * `geom_line()`: lines connecting points by increasing value of x
    * `geom_path()`: lines connecting points in sequence of appearance
    * `geom_boxplot()`: box and whiskers plot for categorical variables
    * `geom_bar()`: bar charts for categorical x axis
    * `geom_histogram()`: histogram for continuous x axis

---
## How layer in ggplot works

1. Create a simple plot object:
  * `plot.object &lt;- ggplot()`

2. Add graphical layers:
  * `plot.object &lt;- plot.object + layer()`

3. Repeat step 2 until statisfied, then print:
  * `plot.object` or `print(plot.object)`  

---
## Prepare data for ggplot

The package `ggplot2` requires you to prepare the data in the class `data.frame` or a format common in the `tidyverse` like a class `tibble`.


```r
class(iris) # all set! 
# [1] "data.frame"

ir = as.tibble(iris) # acceptable
class(ir)
# [1] "tbl_df"     "tbl"        "data.frame"
```

---

## Iris database


```r
?iris
```

5 Variables : 

|Sepal length | Sepal Width | Petal Length | Petal with | 5 Species
:-------------:|:-------------:
Type|Numeric|Numeric|Numeric|Numeric|Categoric

.center[**Scientific questions**]
- Is there a relation between the **length &amp; the width** of the iris **Sepal** ?
- length &amp; the width of the iris **Petal** ?
- Does the sizes of the two organs, **Petal &amp; Sepal**, covariate ?
- How these measures distributed among **5 species** of Iris ?

.center[.alert[How to graphically address this question with ggplot ?]]

---

## Exploring your data structure


&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;

---

## Example with the Iris database
.alert[
- Is there a relation between the **length &amp; the width** of the iris **Sepal** ?
]

```r
ggplot(data = iris,             # Data
       aes(x = Sepal.Length,    # Your X-value
           y = Sepal.Width,     # Your Y-value
           col = Species)) +    # Aesthetics
  geom_point() +                # Geometry
  geom_smooth(method = "lm") +  # Linear regression
  ggtitle("My fabulous graph")+ # Title
  theme(plot.title= element_text(color="black", size=14, face="bold")) #| Theme
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;

---

## Data structure is important
Here we assume that the databases were all cleaned up and that they are ready to be used for graphing. Our second workshop "Loading and manipulating data" summarise best practices: http://qcbs.ca/wiki/r_workshop2

&lt;!-- Explain the databases before the examples  --&gt;
.pull-left[

```
#   Sepal.Length Sepal.Width Species
# 1          5.1         3.5  setosa
# 2          4.9         3.0  setosa
# 3          4.7         3.2  setosa
# 4          4.6         3.1  setosa
# 5          5.0         3.6  setosa
```
]

.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;
]
`ggplot(data = iris, aes(`**x = Sepal.Length ** ` , `
** y = Sepal.Width**`, `** col = Species**`))`

---

## Inheritance: applies to different layer or not

.small[

.pull-left[
**Inheritance from ggplot**

```r

p &lt;- ggplot(data = iris,
            aes(x = Sepal.Length,
                y = Sepal.Width))
q &lt;- p + geom_point()
q   # Print your final plot

```
]

.pull-right[
**No inheritance from ggplot**

```r
s &lt;- ggplot()
s &lt;- gplot.obj +
 geom_point(data = iris,
            aes(x = Sepal.Length,
                y = Sepal.Width))
s
```
]

]

---
## Grammar of Graphics [recall]

Remember: a graphic is made of different layers:

&lt;div style="text-align:center"&gt;
&lt;img src="images/Layers_ggplot.png" height=90% width=90%&gt;
&lt;/div&gt;

---
## GGplot dynamics: base layer

```r
ggplot() + 
scale_x_continuous() +
scale_y_continuous() 
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

---
## GGplot dynamics: data layer


```r
ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  xlab("x = Sepal Lenght") +
  ylab("y = Sepal Width")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;

---

## GGplot dynamics: geometric Layer

```r
ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  xlab("x = Sepal Lenght") + ylab("y = Sepal Width") + 
  geom_point()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;

---

# Challenge #1 (5min)

  .center[**Draw your 1rst GGplot**]

  * .alert[Question] : Is there a relation between the **length &amp; the width** of the iris **Petal** ?

.center[Parameters to consider when addressing this question:]

 data | geom | x value | y value
:-------------:|:-------------:|:-------------:|:-------------:
iris|geom_point|Petal length|Petal width

* Does the *width* of the Petal increase with its *length* ?

---

## Solution Challenge 1#

```r
ggplot(data = iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;

---

class: inverse, center, middle

# Fine-tuning your plots (aes, scales): colour, shape, sizes, etc.

---

## Aesthetic
  * Different aesthetic are available to help you distinguish different class, group &amp; structure within your data:
  
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /&gt;

---

## Color : make your points talk

Color may be usefull to differentiate between variables

Variable|color
:-------------:|:-------------:
Categoric|specific
Numeric|gradient

---

## Example of aesthetic color with our Iris plot

* Do the size and width of the sepals vary differently between species?

.small[
.pull-left[

```r
ggplot(data = iris, aes(x = Sepal.Length, 
                        y = Sepal.Width)) +
  geom_point()
#Without Color
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-22-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[

```r
ggplot(data = iris, aes(x = Sepal.Length, 
                        y = Sepal.Width, 
                        color = Species)) +
  geom_point()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-24-1.png" style="display: block; margin: auto;" /&gt;
]
]

---
## Fine-tuning: Manually increasing colour contrast
  * Colour: Manual_colour
.small[

```r
iris.plot &lt;- ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
            geom_point()
iris.plot + scale_colour_manual(values = c("setosa" = "red", 
                                           "versicolor" = "darkgreen",
                                           "virginica"="blue"))
```
]
.pull-left[
**Classic**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-26-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Manual**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /&gt;
]

---

## Fine-tuning: Gradient colours for quantitative variable
*quantitavie variable: Petal.Length*

```r
iris.plot.petal &lt;- ggplot(data=iris, aes(..., color = Petal.Length))
```
.pull-left[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-29-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-30-1.png" style="display: block; margin: auto;" /&gt;
]

---

## Fine-tuning: colours
  * Coulours theme

```r
install.packages("RColorBrewer")
require(RColorBrewer)

display.brewer.all()
```

&lt;div style="text-align:center"&gt;
&lt;img src="images/Rcolour Brewers palette prez.png" height=100% width=100%&gt;
&lt;/div&gt;

---

## Fine-tuning: colours
  * Coulours theme: RColorBrewer

```r
iris.plot + scale_color_brewer(palette = "Dark2")
```
.pull-left[
**Classic**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-33-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Dark2**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-34-1.png" style="display: block; margin: auto;" /&gt;
]

---

## Fine-tuning: Colour
* Blind color friendly: presentation purpose

```r
cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-36-1.png" style="display: block; margin: auto;" /&gt;

---

## Fine-tuning: Colour
  * Blind color friendly: presentation purpose

```r
cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
iris.plot + scale_color_manual(values=cbbPalette)
```

.pull-left[
**Classic**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-38-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Blind color friendly**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-39-1.png" style="display: block; margin: auto;" /&gt;
]

---

## Fine-tuning: Colour
  * black &amp; white: grey scale for publication purpose

```r
iris.plot + scale_color_grey()
```
.pull-left[
**Defaut**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-41-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Grey scale**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-42-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Challenge #2

Produce a colourful plot from built in data such as the , Iris, CO2 or the msleep dataset

Data|x value|y value| Aesthetic
:-------------:|:-------------:|:-------------:|:-------------:
iris|Petal.Length|Petal.Width|Species
CO2|conc|uptake|Treatment &amp; Type
msleep|log10(bodywt)|awake| vore &amp; conservation

---

## Solution to challenge #2

Example using iris database

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-43-1.png" style="display: block; margin: auto;" /&gt;

---
## Solution to challenge #2

Example using CO2 database

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-44-1.png" style="display: block; margin: auto;" /&gt;

---
## Solution to challenge #2

Example using msleep database

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-45-1.png" style="display: block; margin: auto;" /&gt;


---
## Changing the coordinate system or axis type

&lt;!-- change this example... --&gt;

```r
d &lt;- subset(diamonds, carat &gt; 0.5)

ggplot(d, aes(carat, price)) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_x_log10() +
  scale_y_log10()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-46-1.png" style="display: block; margin: auto;" /&gt;

```r

ggplot(d, aes(carat, price)) +
  geom_point() +
  geom_smooth(method = "lm") +
  coord_trans(x = "log10", y = "log10")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-46-2.png" style="display: block; margin: auto;" /&gt;


---
class: inverse, center, middle

# Fine-tuning your plots (theme): make it look good!

---
## Fine-tuning: Theme
  * Theme: classic for publication purpose

```r
iris.plot + scale_color_grey() + theme_classic()
```
.pull-left[
**Defaut**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-48-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Classic**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-49-1.png" style="display: block; margin: auto;" /&gt;
]

---
## Theme assist: RStudio addin for ggGplot2

![](./images/ggThemeAssist2.gif)

---
class: inverse, center, middle

# Fine-tuning your plots (facets): arrangement of plots

---
## Facet: Iris

```r
ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width, 
                        color = Species)) +
  geom_point() + 
  facet_grid(~Species, scales = "free") 
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-50-1.png" style="display: block; margin: auto;" /&gt;

---
## Facet: CO2
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-51-1.png" style="display: block; margin: auto;" /&gt;


&lt;!-- relabeling ticks --&gt;

---
## Fine-tuning: Title &amp; Axis size, color, face
&lt;div style="text-align:center"&gt;
&lt;img src="images/theme_iris_annotated.png" height=80% width=80%&gt;
&lt;/div&gt;

---
## Fine-tuning: Title &amp; Axis size, color, face

.pull-left[
**Default**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-52-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
**Axis &amp; Title tunning**
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-53-1.png" style="display: block; margin: auto;" /&gt;

]

---

# Challenge #3
* Voici un graphique issu du set de données « tips » inclu avec la librarie "reshape2"
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-54-1.png" style="display: block; margin: auto;" /&gt;

---

## Result Challenge #3

```r
tips.gg &lt;- ggplot(tips, aes(x = total_bill,
                            y = tip/total_bill,
                            shape = smoker, 
                            color = sex, 
                            size = size))
tips.gg &lt;- tips.gg + geom_point()
tips.gg &lt;- tips.gg + facet_grid( ~ time)
tips.gg &lt;- tips.gg + scale_color_manual(values=cbbPalette)
tips.gg &lt;- tips.gg + ggtitle("Tips per total bill at Lunch and Dinner")
tips.gg &lt;- tips.gg + theme(axis.title.x = element_text(size = 16, colour = cbbPalette[6]),
                           axis.title.y = element_text(size = 16, colour = cbbPalette[6]),
                           axis.text.x = element_text(size = 12),
                           axis.text.y = element_text(size = 12),
                           plot.title = element_text(size = 16, colour = cbbPalette[7], face="bold"),
                           strip.text.x = element_text(size = 14, face="bold"))
tips.gg

```

---

## Result Challenge #3: step by step
*Aesthetic*

```r
tips.gg &lt;- ggplot(tips, aes(x = total_bill,
                            y = tip/total_bill,
                            shape = smoker, 
                            color = sex, 
                            size = size))
tips.gg + geom_point()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-56-1.png" style="display: block; margin: auto;" /&gt;



---

## Result Challenge #3: step by step
*Facet*

```r
tips.gg + facet_grid( ~ time)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-58-1.png" style="display: block; margin: auto;" /&gt;



---

## Result Challenge #3: step by step
*Blind color palette*

```r
tips.gg + scale_color_manual(values=cbbPalette)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-60-1.png" style="display: block; margin: auto;" /&gt;



---

## Result Challenge #3: step by step
*Plot Title*

```r
tips.gg + ggtitle("Tips per total bill at Lunch and Dinner")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-62-1.png" style="display: block; margin: auto;" /&gt;



---

## Result Challenge #3: step by step
*Theme tunning: Plot &amp; Axis Title*
.small[

```r
tips.gg + theme(axis.title.x = element_text(size = 16, colour = cbbPalette[6]),
                           axis.title.y = element_text(size = 16, colour = cbbPalette[6]),
                           axis.text.x = element_text(size = 12),
                           axis.text.y = element_text(size = 12),
                           plot.title = element_text(size = 16, colour = cbbPalette[7], face="bold"),
                           strip.text.x = element_text(size = 14, face="bold"))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-64-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Geom: GGplot
&lt;div style="text-align:center"&gt;
&lt;img src="images/plots_in_various_contexts.png" height=85% width=85%&gt;
&lt;/div&gt;

---

#Base plot
&lt;div style="text-align:center"&gt;
&lt;img src="images/plots_in_various_contexts_baseplot.png" height=85% width=85%&gt;
&lt;/div&gt;

---

##Blank plot
.pull-left[
*GGplot2*

```r
gblank &lt;- ggplot(mtcars, aes(wt, mpg))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-66-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
plot(mpg~wt, data = mtcars, type = "n")
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-67-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Histogram
An histogram is an accurate graphical representation of the distribution of numeric data
.pull-left[

```r
ggplot(iris, aes(Sepal.Length)) +
  geom_histogram() + ggtitle("Histogram of sepal length ") 
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-68-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[

```r
ggplot(cars, aes(dist)) +
  geom_histogram() + ggtitle("Histogram of car distance taken to stop ") 
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-69-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Histogram

.pull-left[
*GGplot2*

```r
ggplot(diamonds, aes(carat)) + geom_histogram()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-71-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
hist(diamonds$carat)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-72-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Barplot
.pull-left[
*GGplot2*

```r
ggplot(mpg, aes(class)) + geom_bar()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-74-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
barplot(table(mpg$class))
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-75-1.png" style="display: block; margin: auto;" /&gt;
]

---

# Significant values
.pull-left[
*GGplot2*

```r
ggplot(mpg, aes(class)) + 
  geom_bar() + 
  geom_signif()
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-77-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*
Manual function

```r
barplot()
sign.bar() 
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-79-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Plot: linear reagression

.pull-left[
*GGplot2*

```r
ggplot(mpg, aes(displ, hwy)) + 
  geom_point() + 
  geom_smooth(method = lm)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-81-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
lm.out  &lt;- lm(hwy~displ, data = mpg)
plot(hwy~displ, data = mpg)
abline(lm.out)

```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-83-1.png" style="display: block; margin: auto;" /&gt;
]

---

# Boxplot

&lt;div style="text-align:center"&gt;
&lt;img src="images/boxplot_explain.png" height=85% width=85%&gt;
&lt;/div&gt;

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-84-1.png" style="display: block; margin: auto;" /&gt;

---

#Boxplot with significant value

.pull-left[
*GGplot2*

```r
ggplot(data = iris, aes(Species, Sepal.Length)) + 
  geom_boxplot()  
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-86-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
boxplot(iris$Sepal.Length ~ iris$Species)

```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-88-1.png" style="display: block; margin: auto;" /&gt;
]

---

# Violin plot

Violin plots allow to visualize the distribution of a numeric variable for one or several groups. 

Close from a boxplot, it allows a deeper understanding of the density and are particularly adapted when the amount of data is huge.

.pull-left[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-89-1.png" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-90-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Violin plot

.pull-left[
*GGplot2*

```r
ggplot(data = iris, aes(Species, 
                        Sepal.Length)) + 
  geom_violin()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-92-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
vioplot(iris$Sepal.Length[iris$Species == "setosa"],
        iris$Sepal.Length[iris$Species == "versicolor"],
        iris$Sepal.Length[iris$Species == "virginica"],
        col = "lightblue")

```

```
# [1] 4.3 7.9
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-94-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Plot with errors bars

.pull-left[
*GGplot2*

```r
ggplot(df, aes(trt, resp, colour = group)) +
  geom_pointrange()+
  geom_errorbar() + 
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-96-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
plot(y~x)
error.bar &lt;- function(...)
error.bar(x,y)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-98-1.png" style="display: block; margin: auto;" /&gt;

]

---

#Map

.pull-left[
*GGplot2*

```r
library(maps)
states_map &lt;- map_data("state")
ggplot(crimes, aes(map_id = state)) +
  geom_map() + coord_map()
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-100-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
library(rworldmap)
library(mapproj)
newmap &lt;- rworldmap::getMap(resolution = "high")
plot(newmap)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-102-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Density Graph

A density plot shows the distribution of a numerical variable and it takes only set of numeric values as input
.pull-left[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-103-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-104-1.png" style="display: block; margin: auto;" /&gt;
]

---
#Density Graph

.pull-left[
*GGplot2*

```r
ggplot(diamonds, aes(carat)) +
  geom_density() 
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-106-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
plot(density(c(-20, rep(0,98), 20)), 
     xlim = c(-4, 4))
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-108-1.png" style="display: block; margin: auto;" /&gt;
]

---

#Dendogram

.pull-left[
*GGplot2*

```r
ggdendrogram(hc)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-110-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
*Base Plot*

```r
plot(hc, hang = -1, main = "Dendrogram")
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-112-1.png" style="display: block; margin: auto;" /&gt;

]

---

# Multiplot
**A function to add multiple graph on the same plot**

```r
multiplot(density.gg, map.gg, violP.gg, lm.gg, cols = 2)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-113-1.png" style="display: block; margin: auto;" /&gt;

---

# Final Challenge
  * Dataset: any (recommanded: use your dataset)

```r
data(msleep) ; data(mtcars) ; data(OrchardSprays)
```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-115-1.png" style="display: block; margin: auto;" /&gt;


---

.small[

```r
msleep.challenge4 &lt;- ggplot(msleep, aes(vore, log10(brainwt), fill=vore))  
msleep.challenge4 &lt;- msleep.challenge4 + geom_violin()
msleep.challenge4 &lt;- msleep.challenge4 + geom_signif(comparisons = list(c("herbi", "insecti")))
msleep.challenge4 &lt;- msleep.challenge4 + ggtitle("Brain weight among different vore")
msleep.challenge4 &lt;- msleep.challenge4 + ylab("Brain weight (log10(Kg))")
msleep.challenge4 &lt;- msleep.challenge4 + scale_fill_grey() 
msleep.challenge4 &lt;- msleep.challenge4 + theme_classic()
msleep.challenge4 &lt;- msleep.challenge4 + theme(axis.title.x = element_text(size = 16),
                                               axis.title.y = element_text(size = 16),
                                               axis.text.x = element_text(size = 12),
                                               axis.text.y = element_text(size = 12),
                                               plot.title = element_text(size = 16, face="bold"),
                                               legend.title = element_text(size=14, face="bold"),
                                               legend.text = element_text(size=12))

```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-117-1.png" style="display: block; margin: auto;" /&gt;
]

---

.small[

```r
brain_body.challenge4 &lt;- ggplot(msleep, aes(log10(bodywt), log10(brainwt))) 
brain_body.challenge4 &lt;- brain_body.challenge4 + geom_point()
brain_body.challenge4 &lt;- brain_body.challenge4 + geom_smooth(method = lm)
brain_body.challenge4 &lt;- brain_body.challenge4 + ggtitle("Linear regression on bodywt ~ brainwt")
brain_body.challenge4 &lt;- brain_body.challenge4 + ylab("Brain weight log10(Kg)") + xlab("Body weight log10(Kg)")
brain_body.challenge4 &lt;- brain_body.challenge4 + theme(axis.title.x = element_text(size = 16),
                                                       axis.title.y = element_text(size = 16),
                                                       axis.text.x = element_text(size = 12),
                                                       axis.text.y = element_text(size = 12),
                                                       plot.title = element_text(size = 14, face="bold"),
                                                       legend.title = element_text(size=14, face="bold"),
                                                       legend.text = element_text(size=12))

```
&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-119-1.png" style="display: block; margin: auto;" /&gt;

]

---

.small[

```r
mtcars.short &lt;- mtcars[1:20,]
mtcars.short.hc &lt;- hclust(dist(mtcars.short), "complete")
dendro.challenge4 &lt;- ggdendrogram(mtcars.short.hc, rotate = TRUE, theme_dendro = FALSE)
dendro.challenge4 &lt;- dendro.challenge4 + ggtitle("Car dendro from motor spec")
dendro.challenge4 &lt;- dendro.challenge4 + xlab("Cars")
dendro.challenge4 &lt;- dendro.challenge4 + theme(axis.title.y = element_text(size = 16),
                                               axis.title.x = element_blank(),
                                               axis.text.x = element_blank(),
                                               axis.text.y = element_text(size = 12),
                                               plot.title = element_text(size = 14, face="bold"))
dendro.challenge4 
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-120-1.png" style="display: block; margin: auto;" /&gt;
]

---

.small[

```r
Orchard.challenge4 &lt;- ggplot(data = OrchardSprays, aes(x=treatment, y=decrease)) + geom_boxplot()
Orchard.challenge4 &lt;- Orchard.challenge4 + ggtitle("Decrease of Orchad bees with different treatments")
Orchard.challenge4 &lt;- Orchard.challenge4 + ylab("Orchad bees decrese")
Orchard.challenge4 &lt;- Orchard.challenge4 + theme(axis.title.y = element_text(size = 14),
                                                 axis.title.x = element_text(size = 14),
                                                 axis.text.x = element_text(size = 12),
                                                 axis.text.y = element_text(size = 12),
                                                 plot.title = element_text(size = 14, face="bold"))
Orchard.challenge4
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-121-1.png" style="display: block; margin: auto;" /&gt;
]

---

# Solution to final challenge


```r
multiplot(msleep.challenge4,dendro.challenge4, brain_body.challenge4, Orchard.challenge4, cols = 2)
```

&lt;img src="workshop03-en_files/figure-html/unnamed-chunk-122-1.png" style="display: block; margin: auto;" /&gt;

---
# Miscellaneous: Dynamics plots
.alert[**Select the Species data to display directly From the legend**]
<div id="htmlwidget-952792dc33c82eb027f8" style="width:792px;height:540px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-952792dc33c82eb027f8">{"x":{"data":[{"x":[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5],"y":[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3],"text":["Sepal.Length: 5.1<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.7<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.6<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.9<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.4<br />Sepal.Width: 2.9<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.7<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.3<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.8<br />Sepal.Width: 4.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.7<br />Sepal.Width: 4.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.9<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.7<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.7<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.6<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.3<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.2<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.2<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.7<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.4<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.2<br />Sepal.Width: 4.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.5<br />Sepal.Width: 4.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.1<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.5<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.9<br />Sepal.Width: 3.6<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.4<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.4<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.5<br />Sepal.Width: 2.3<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.4<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.5<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.8<br />Sepal.Width: 3.0<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.1<br />Sepal.Width: 3.8<br />Species: setosa<br />Species: setosa","Sepal.Length: 4.6<br />Sepal.Width: 3.2<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.3<br />Sepal.Width: 3.7<br />Species: setosa<br />Species: setosa","Sepal.Length: 5.0<br />Sepal.Width: 3.3<br />Species: setosa<br />Species: setosa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.6,"size":22.6771653543307,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"setosa","legendgroup":"setosa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7],"y":[3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8],"text":["Sepal.Length: 7.0<br />Sepal.Width: 3.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.4<br />Sepal.Width: 3.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.9<br />Sepal.Width: 3.1<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.5<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.3<br />Sepal.Width: 3.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 4.9<br />Sepal.Width: 2.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.6<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.2<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.0<br />Sepal.Width: 2.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.9<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 2.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.7<br />Sepal.Width: 3.1<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.2<br />Sepal.Width: 2.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.9<br />Sepal.Width: 3.2<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.3<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.4<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.6<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.8<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.7<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.6<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.4<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.0<br />Sepal.Width: 3.4<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.7<br />Sepal.Width: 3.1<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.3<br />Sepal.Width: 2.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.5<br />Sepal.Width: 2.6<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.1<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.8<br />Sepal.Width: 2.6<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.0<br />Sepal.Width: 2.3<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.6<br />Sepal.Width: 2.7<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 3.0<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 6.2<br />Sepal.Width: 2.9<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.1<br />Sepal.Width: 2.5<br />Species: versicolor<br />Species: versicolor","Sepal.Length: 5.7<br />Sepal.Width: 2.8<br />Species: versicolor<br />Species: versicolor"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":0.6,"size":22.6771653543307,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"versicolor","legendgroup":"versicolor","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"y":[3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],"text":["Sepal.Length: 6.3<br />Sepal.Width: 3.3<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.1<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.9<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.6<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 4.9<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.3<br />Sepal.Width: 2.9<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.2<br />Sepal.Width: 3.6<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.8<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.7<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.8<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 3.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 2.6<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.0<br />Sepal.Width: 2.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.9<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.6<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.3<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.2<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.2<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.1<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.2<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.4<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.9<br />Sepal.Width: 3.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.8<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.1<br />Sepal.Width: 2.6<br />Species: virginica<br />Species: virginica","Sepal.Length: 7.7<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 3.4<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.4<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.0<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.9<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.9<br />Sepal.Width: 3.1<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.8<br />Sepal.Width: 2.7<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.8<br />Sepal.Width: 3.2<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.3<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.7<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.3<br />Sepal.Width: 2.5<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.5<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica","Sepal.Length: 6.2<br />Sepal.Width: 3.4<br />Species: virginica<br />Species: virginica","Sepal.Length: 5.9<br />Sepal.Width: 3.0<br />Species: virginica<br />Species: virginica"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":0.6,"size":22.6771653543307,"symbol":"square","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"virginica","legendgroup":"virginica","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.7153729071537,"r":7.30593607305936,"b":40.6697108066971,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.12,8.08],"tickmode":"array","ticktext":["5","6","7","8"],"tickvals":[5,6,7,8],"categoryorder":"array","categoryarray":["5","6","7","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Sepal.Length","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.88,4.52],"tickmode":"array","ticktext":["2.0","2.5","3.0","3.5","4.0","4.5"],"tickvals":[2,2.5,3,3.5,4,4.5],"categoryorder":"array","categoryarray":["2.0","2.5","3.0","3.5","4.0","4.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Sepal.Width","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.942257217847769},"annotations":[{"text":"Species","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"201819596a5e":{"x":{},"y":{},"colour":{},"shape":{},"type":"scatter"}},"cur_data":"201819596a5e","visdat":{"201819596a5e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---
class: inverse, center, middle

# Saving your plots with ggplot2

---

## Saving plots in RStudio

&lt;div style="text-align:center"&gt;
&lt;img src="images/save_image.png" height=70% width=70%&gt;
&lt;/div&gt;

Think about the margin of the document you are using. If you resize the image after saving it, the labels and text will change size as well which could be hard to read. 

---
## Saving plots in code

ggsave() will write directly to your working directory all in one line of code and you can specify the name of the file and the dimensions of the plot:


```r
my1rstPlot &lt;- ggplot(data = iris, 
                     aes(x = Petal.Length, 
                         y = Petal.Width)) + 
  geom_point()
ggsave("my1rstPlot.pdf", 
       my1rstPlot, 
       height = 8.5, 
       width = 11, 
       units = "in")
```
Note that vector format (e.g., pdf, svg) are often preferable choice compared to raster format (jpeg, png, ...). Vectors format will be more flexible if the image needs modification after saving it. 

Other methods to save image
`?pdf`
`?jpeg`

```r
pdf("./graph_du_jour.pdf")
  print(my1rstPlot) # print function is necessary
graphics.off()
```



---
class: inverse, center, middle

# Going further


---
## Available elements

[Data Visualization with ggplot2 Cheat Sheet](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)

&lt;div style="text-align:center"&gt;
&lt;img src="images/available_geom.png" height=55% width=55%&gt;
&lt;/div&gt;

https://www.rstudio.com/resources/cheatsheets

---
## Additional resources

`help(package = ggplot)`

http://ggplot2.tidyverse.org/reference/

&lt;div&gt;
  &lt;img src="images/ggplot_book.jpg"/&gt;
  &lt;img src="images/grammar_of_graphics.jpg"/&gt;
&lt;/div&gt;

---
# Conclusion

Now that you understand the ggplot basics, you can learn more about about design and image manipulation with the "Introduction to graphic design and image manipulation with open source tools": https://qcbs.ca/wiki/graphics \s\s


There might be other useful packages that can be used in conjunction with `ggplot2` that we haven't covered (e.g. ggbio, ggpmisc, geomnet, gganimate, ggnetwork, ggtree, and more!).
https://www.ggplot2-exts.org/ggrepel.html 

---
class: inverse, center, bottom

# Thank you for attending!

![:scale 50%](images/QCBS_logo.png)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="qcbsR-macros.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
