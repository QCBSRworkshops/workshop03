<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 The basics of visualizing data | Workshop 3: Introduction to ggplot2</title>
  <meta name="description" content="Introduction to ggplot2" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 The basics of visualizing data | Workshop 3: Introduction to ggplot2" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Introduction to ggplot2" />
  <meta name="github-repo" content="qcbsRworkshops/workshop03" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 The basics of visualizing data | Workshop 3: Introduction to ggplot2" />
  
  <meta name="twitter:description" content="Introduction to ggplot2" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="grammar-of-graphics-gg-basics.html"/>
<link rel="next" href="aesthetics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Introduction to <code>ggplot2</code></b></span></li>
<li class="chapter" data-level="1" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>1</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="2" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>2</b> Learning objectives</a><ul>
<li class="chapter" data-level="2.1" data-path="learning-objectives.html"><a href="learning-objectives.html#workshop-outline"><i class="fa fa-check"></i><b>2.1</b> Workshop outline</a></li>
</ul></li>
<li class="part"><span><b>Visualization in science</b></span></li>
<li class="chapter" data-level="3" data-path="why-do-we-visualize-data.html"><a href="why-do-we-visualize-data.html"><i class="fa fa-check"></i><b>3</b> Why do we visualize data?</a></li>
<li class="chapter" data-level="4" data-path="why-use-r.html"><a href="why-use-r.html"><i class="fa fa-check"></i><b>4</b> Why use <code>R</code>?</a><ul>
<li class="chapter" data-level="4.1" data-path="why-use-r.html"><a href="why-use-r.html#reproducibility"><i class="fa fa-check"></i><b>4.1</b> Reproducibility</a></li>
<li class="chapter" data-level="4.2" data-path="why-use-r.html"><a href="why-use-r.html#powerful-features"><i class="fa fa-check"></i><b>4.2</b> Powerful features</a></li>
</ul></li>
<li class="part"><span><b><code>ggplot2</code> mechanics: the basics</b></span></li>
<li class="chapter" data-level="5" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html"><i class="fa fa-check"></i><b>5</b> Grammar of Graphics (GG) basics</a><ul>
<li class="chapter" data-level="5.1" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#what-is-the-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1</b> What is the Grammar of Graphics?</a></li>
<li class="chapter" data-level="5.2" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#gg-layers"><i class="fa fa-check"></i><b>5.2</b> Grammar of Graphics layers</a><ul>
<li class="chapter" data-level="5.2.1" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#a-breakdown-of-common-layers"><i class="fa fa-check"></i><b>5.2.1</b> A breakdown of common layers</a></li>
<li class="chapter" data-level="5.2.2" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#putting-these-layers-together"><i class="fa fa-check"></i><b>5.2.2</b> Putting these layers together</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html"><i class="fa fa-check"></i><b>6</b> The basics of visualizing data</a><ul>
<li class="chapter" data-level="6.1" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#todays-dataset-palmerpenguins"><i class="fa fa-check"></i><b>6.1</b> Today’s dataset: <code>palmerpenguins</code></a></li>
<li class="chapter" data-level="6.2" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#asking-questions"><i class="fa fa-check"></i><b>6.2</b> Asking questions</a></li>
<li class="chapter" data-level="6.3" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#exploring-data-structure"><i class="fa fa-check"></i><b>6.3</b> Exploring data structure</a></li>
<li class="chapter" data-level="6.4" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#working-through-layers"><i class="fa fa-check"></i><b>6.4</b> Working through the layers</a><ul>
<li class="chapter" data-level="6.4.1" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#data-layer"><i class="fa fa-check"></i><b>6.4.1</b> Data layer</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#aesthetics-layer"><i class="fa fa-check"></i><b>6.4.2</b> Aesthetics layer</a></li>
<li class="chapter" data-level="6.4.3" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#geometric-layer"><i class="fa fa-check"></i><b>6.4.3</b> Geometric layer</a></li>
<li class="chapter" data-level="6.4.4" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#facets-coordinates-and-themes"><i class="fa fa-check"></i><b>6.4.4</b> Facets, coordinates, and themes</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#challenge-1"><i class="fa fa-check"></i><b>6.5</b> Challenge 1</a><ul>
<li class="chapter" data-level="6.5.1" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#challenge-1-solution"><i class="fa fa-check"></i><b>6.5.1</b> Challenge 1: Solution</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Aesthetic mapping</b></span></li>
<li class="chapter" data-level="7" data-path="aesthetics.html"><a href="aesthetics.html"><i class="fa fa-check"></i><b>7</b> Aesthetics</a></li>
<li class="chapter" data-level="8" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html"><i class="fa fa-check"></i><b>8</b> Colours: make your points talk</a><ul>
<li class="chapter" data-level="8.1" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#using-aes-use-to-change-colour"><i class="fa fa-check"></i><b>8.1</b> Using <code>aes()</code> use to change colour</a></li>
<li class="chapter" data-level="8.2" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#manual-colour-change"><i class="fa fa-check"></i><b>8.2</b> Manual colour change</a></li>
<li class="chapter" data-level="8.3" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#gradients"><i class="fa fa-check"></i><b>8.3</b> Gradients</a></li>
<li class="chapter" data-level="8.4" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#use-a-new-colour-palette"><i class="fa fa-check"></i><b>8.4</b> Use a new colour palette</a></li>
<li class="chapter" data-level="8.5" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#colourblind-friendly-palettes"><i class="fa fa-check"></i><b>8.5</b> Colourblind-friendly palettes</a><ul>
<li class="chapter" data-level="8.5.1" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#example-for-grouped-data"><i class="fa fa-check"></i><b>8.5.1</b> Example for grouped data</a></li>
<li class="chapter" data-level="8.5.2" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#example-for-continuous-data"><i class="fa fa-check"></i><b>8.5.2</b> Example for continuous data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html"><i class="fa fa-check"></i><b>9</b> Changing <code>shape</code>, <code>size</code> and <code>alpha</code></a><ul>
<li class="chapter" data-level="9.1" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2"><i class="fa fa-check"></i><b>9.1</b> Challenge 2</a><ul>
<li class="chapter" data-level="9.1.1" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-mtcars"><i class="fa fa-check"></i><b>9.1.1</b> Challenge 2: Solution (<code>mtcars</code>)</a></li>
<li class="chapter" data-level="9.1.2" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-co2"><i class="fa fa-check"></i><b>9.1.2</b> Challenge 2: Solution (<code>CO2</code>)</a></li>
<li class="chapter" data-level="9.1.3" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-msleep"><i class="fa fa-check"></i><b>9.1.3</b> Challenge 2: Solution (<code>msleep</code>)</a></li>
<li class="chapter" data-level="9.1.4" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-toothgrowth"><i class="fa fa-check"></i><b>9.1.4</b> Challenge 2: Solution (<code>ToothGrowth</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="changing-the-scale-of-the-axes.html"><a href="changing-the-scale-of-the-axes.html"><i class="fa fa-check"></i><b>10</b> Changing the scale of the axes</a></li>
<li class="part"><span><b>Fine-tuning your plots</b></span></li>
<li class="chapter" data-level="11" data-path="theme.html"><a href="theme.html"><i class="fa fa-check"></i><b>11</b> Using <code>theme()</code> to make it look good!</a><ul>
<li class="chapter" data-level="11.1" data-path="theme.html"><a href="theme.html#introduction-to-themes"><i class="fa fa-check"></i><b>11.1</b> Introduction to themes</a><ul>
<li class="chapter" data-level="11.1.1" data-path="theme.html"><a href="theme.html#default-grey"><i class="fa fa-check"></i><b>11.1.1</b> Default: Grey</a></li>
<li class="chapter" data-level="11.1.2" data-path="theme.html"><a href="theme.html#theme-classic"><i class="fa fa-check"></i><b>11.1.2</b> Theme Classic</a></li>
<li class="chapter" data-level="11.1.3" data-path="theme.html"><a href="theme.html#theme-minimal"><i class="fa fa-check"></i><b>11.1.3</b> Theme Minimal</a></li>
<li class="chapter" data-level="11.1.4" data-path="theme.html"><a href="theme.html#setting-the-theme-across-all-plots"><i class="fa fa-check"></i><b>11.1.4</b> Setting the theme across all plots</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="theme.html"><a href="theme.html#elements-of-a-theme"><i class="fa fa-check"></i><b>11.2</b> Elements of a theme</a></li>
<li class="chapter" data-level="11.3" data-path="theme.html"><a href="theme.html#building-your-own-theme"><i class="fa fa-check"></i><b>11.3</b> Building your own theme</a></li>
<li class="chapter" data-level="11.4" data-path="theme.html"><a href="theme.html#more-themes"><i class="fa fa-check"></i><b>11.4</b> More themes</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html"><i class="fa fa-check"></i><b>12</b> Using facets to split up your plot</a><ul>
<li class="chapter" data-level="12.1" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#facetting-by-one-variable"><i class="fa fa-check"></i><b>12.1</b> Facetting by one variable</a></li>
<li class="chapter" data-level="12.2" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#facetting-by-two-variables"><i class="fa fa-check"></i><b>12.2</b> Facetting by two variables</a></li>
<li class="chapter" data-level="12.3" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#title-and-axes-components-size-colour-and-face"><i class="fa fa-check"></i><b>12.3</b> Title and axes components: size, colour and face</a></li>
<li class="chapter" data-level="12.4" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#challenge-3"><i class="fa fa-check"></i><b>12.4</b> Challenge 3</a><ul>
<li class="chapter" data-level="12.4.1" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#challenge-3-solution"><i class="fa fa-check"></i><b>12.4.1</b> Challenge 3: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html"><i class="fa fa-check"></i><b>13</b> Using <code>geom_*()</code> to create different plots</a><ul>
<li class="chapter" data-level="13.1" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#histograms-geom_histogram"><i class="fa fa-check"></i><b>13.1</b> Histograms: <code>geom_histogram()</code></a></li>
<li class="chapter" data-level="13.2" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#scatterplot-and-linear-fit-geom_point-and-geom_smooth"><i class="fa fa-check"></i><b>13.2</b> Scatterplot and linear-fit: <code>geom_point()</code> and <code>geom_smooth()</code></a></li>
<li class="chapter" data-level="13.3" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#boxplot-geom_boxplot"><i class="fa fa-check"></i><b>13.3</b> Boxplot: <code>geom_boxplot()</code></a></li>
<li class="chapter" data-level="13.4" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#annotated-boxplot-geom_boxplot-and-geom_signif"><i class="fa fa-check"></i><b>13.4</b> Annotated boxplot: <code>geom_boxplot()</code> and <code>geom_signif()</code></a></li>
<li class="chapter" data-level="13.5" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#violin-plot-geom_violin"><i class="fa fa-check"></i><b>13.5</b> Violin plot: <code>geom_violin()</code></a></li>
<li class="chapter" data-level="13.6" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#summarise-y-values-stat_summary"><i class="fa fa-check"></i><b>13.6</b> Summarise <code>y</code> values: <code>stat_summary()</code></a></li>
<li class="chapter" data-level="13.7" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#representing-maps-geom_map"><i class="fa fa-check"></i><b>13.7</b> Representing maps: <code>geom_map()</code></a></li>
<li class="chapter" data-level="13.8" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#density-plots-geom_density"><i class="fa fa-check"></i><b>13.8</b> Density plots: <code>geom_density()</code></a></li>
<li class="chapter" data-level="13.9" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#dendogram-ggdendrogram"><i class="fa fa-check"></i><b>13.9</b> Dendogram: <code>ggdendrogram()</code></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="arrange-plots-patchwork.html"><a href="arrange-plots-patchwork.html"><i class="fa fa-check"></i><b>14</b> Arrange plots: <code>patchwork</code></a></li>
<li class="chapter" data-level="15" data-path="challenge-4.html"><a href="challenge-4.html"><i class="fa fa-check"></i><b>15</b> Challenge 4</a><ul>
<li class="chapter" data-level="15.1" data-path="challenge-4.html"><a href="challenge-4.html#challenge-4-solution-example-1"><i class="fa fa-check"></i><b>15.1</b> Challenge 4: Solution example 1</a></li>
<li class="chapter" data-level="15.2" data-path="challenge-4.html"><a href="challenge-4.html#challenge-4-solution-example-2"><i class="fa fa-check"></i><b>15.2</b> Challenge 4: Solution example 2</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="miscellaneous-interactive-plots-using-plotly.html"><a href="miscellaneous-interactive-plots-using-plotly.html"><i class="fa fa-check"></i><b>16</b> Miscellaneous: interactive plots using <code>plotly()</code></a></li>
<li class="part"><span><b>Saving your plots</b></span></li>
<li class="chapter" data-level="17" data-path="saving-your-plots-in-code.html"><a href="saving-your-plots-in-code.html"><i class="fa fa-check"></i><b>17</b> Saving your plots in code</a></li>
<li class="part"><span><b>Conclusion</b></span></li>
<li class="chapter" data-level="18" data-path="concluding-remarks.html"><a href="concluding-remarks.html"><i class="fa fa-check"></i><b>18</b> Concluding remarks</a></li>
<li class="chapter" data-level="19" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>19</b> Additional resources</a><ul>
<li class="chapter" data-level="19.1" data-path="additional-resources.html"><a href="additional-resources.html#reference-documents"><i class="fa fa-check"></i><b>19.1</b> Reference documents</a></li>
<li class="chapter" data-level="19.2" data-path="additional-resources.html"><a href="additional-resources.html#books"><i class="fa fa-check"></i><b>19.2</b> Books</a></li>
<li class="chapter" data-level="19.3" data-path="additional-resources.html"><a href="additional-resources.html#inspiration-and-guides"><i class="fa fa-check"></i><b>19.3</b> Inspiration and guides</a></li>
<li class="chapter" data-level="19.4" data-path="additional-resources.html"><a href="additional-resources.html#lecture-notes"><i class="fa fa-check"></i><b>19.4</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 3: Introduction to <code>ggplot2</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="the-basics-of-visualizing-data" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> The basics of visualizing data</h1>
<div id="todays-dataset-palmerpenguins" class="section level2">
<h2><span class="header-section-number">6.1</span> Today’s dataset: <code>palmerpenguins</code></h2>
<p>Now let’s actually try plotting some data! This workshop will be using the dataset from the <code>palmerpenguins</code> <span class="citation">(Horst, Hill, and Gorman <a href="#ref-palmerpenguins" role="doc-biblioref">2020</a>)</span> package.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="images/palmerpenguins.png" alt="Artwork by [Allison Horst](https://twitter.com/allison_horst)." width="30%" />
<p class="caption">
Figure 6.1: Artwork by <a href="https://twitter.com/allison_horst">Allison Horst</a>.
</p>
</div>
<p>This dataset contains size measurements for three penguin species observed on three islands in the Palmer Archipelago, Antarctica. These data were collected from 2007 - 2009 by Dr. Kristen Gorman with the Palmer Station Long Term Ecological Research Program, part of the US Long Term Ecological Research Network.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="images/penguins.png" alt="Artwork by [Allison Horst](https://twitter.com/allison_horst)." width="100%" />
<p class="caption">
Figure 6.2: Artwork by <a href="https://twitter.com/allison_horst">Allison Horst</a>.
</p>
</div>
<div class="explanation">
<p>This dataset is often used to replace the <code>iris</code> dataset, which has some problems for teaching data science, including its ties to eugenics (more on this at <a href="https://armchairecology.blog/iris-dataset/">armchairecology.blog/iris-dataset</a>).</p>
<p>This dataset was also used for a <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a> challenge, showing the many possibilities of visualizing the dataset creatively. For example: <a href="https://twitter.com/LauraNavarroSol/status/1289216490307063814?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1289216490307063814%7Ctwgr%5E%7Ctwcon%5Es1_c10&amp;ref_url=https%3A%2F%2Fnsgrantham.shinyapps.io%2Ftidytuesdayrocks%2F">this</a>, and <a href="https://twitter.com/CedScherer/status/1288181995714093057?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1288181995714093057%7Ctwgr%5E%7Ctwcon%5Es1_c10&amp;ref_url=https%3A%2F%2Fnsgrantham.shinyapps.io%2Ftidytuesdayrocks%2F">this</a>.</p>
</div>
<p>Let’s take a look at the variables in the penguins dataset:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="the-basics-of-visualizing-data.html#cb3-1"></a><span class="kw">str</span>(penguins)  <span class="co"># let&#39;s have a look at some penguin data!</span></span></code></pre></div>
<pre><code>## tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
##  $ species          : Factor w/ 3 levels &quot;Adelie&quot;,&quot;Chinstrap&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ island           : Factor w/ 3 levels &quot;Biscoe&quot;,&quot;Dream&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
##  $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
##  $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
##  $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
##  $ sex              : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 1 NA 1 2 1 2 NA NA ...
##  $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="images/culmen_depth.png" alt="Artwork by [Allison Horst](https://twitter.com/allison_horst)." width="100%" />
<p class="caption">
Figure 6.3: Artwork by <a href="https://twitter.com/allison_horst">Allison Horst</a>.
</p>
</div>
<p>Note that <code>species</code>, <code>island</code>, and <code>sex</code> are factor variables, which will be important for grouping the data with colour, shapes, and other aesthetics in <code>ggplot2</code>. There are then two numeric variables (bill measurements depicted in the image), and two integer variables (flipper length and body mass). The data also has a small temporal component (<code>year</code>), spanning the years from 2007 to 2009.</p>
<p><code>ggplot2</code> requires you to prepare the data as an object of class <code>data.frame</code> or <code>tibble</code> (common in the <code>tidyverse</code>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="the-basics-of-visualizing-data.html#cb5-1"></a><span class="kw">class</span>(penguins)  <span class="co"># check the class of the data to ensure it is either a data.frame or tibble for ggplot2</span></span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="the-basics-of-visualizing-data.html#cb7-1"></a><span class="co"># you can transform a dataset into a tibble using the</span></span>
<span id="cb7-2"><a href="the-basics-of-visualizing-data.html#cb7-2"></a><span class="co"># as_tibble() function if need be peng &lt;-</span></span>
<span id="cb7-3"><a href="the-basics-of-visualizing-data.html#cb7-3"></a><span class="co"># tibble::as_tibble(penguins) class(peng)</span></span></code></pre></div>
<p><strong>♻ Recall from the <a href="https://qcbsrworkshops.github.io/workshop02/book-en/"><em>Loading and manipulating data</em></a> workshop:</strong></p>
<p>More complex plots in <code>ggplot2</code> require the long data frame format.</p>
</div>
<div id="asking-questions" class="section level2">
<h2><span class="header-section-number">6.2</span> Asking questions</h2>
<p>What are some of the scientific questions we may want to answer with this data-set? Here are some examples:</p>
<ul>
<li>Is there a relationship between the <strong>length</strong> &amp; the <strong>depth</strong> of bills?</li>
<li>Does the size of the <strong>bill &amp; flipper</strong> vary together ?</li>
<li>How are these measures distributed among the <strong>3 penguin species</strong> ?</li>
</ul>
<p>How can we graphically address these questions with <code>ggplot2</code>?</p>
</div>
<div id="exploring-data-structure" class="section level2">
<h2><span class="header-section-number">6.3</span> Exploring data structure</h2>
<p>If we want a general overview of our data, we can start by using the <code>ggpairs()</code> function from the <code>GGally</code> package (which we loaded and installed in the beginning of the workshop). This will allow us to look at initial relationships and then explore them in more detail.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="the-basics-of-visualizing-data.html#cb8-1"></a><span class="co">## Get a general overview of the data with multiple plot</span></span>
<span id="cb8-2"><a href="the-basics-of-visualizing-data.html#cb8-2"></a><span class="co">## types</span></span>
<span id="cb8-3"><a href="the-basics-of-visualizing-data.html#cb8-3"></a><span class="kw">ggpairs</span>(penguins, <span class="kw">aes</span>(<span class="dt">colour =</span> species), <span class="dt">progress =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb8-4"><a href="the-basics-of-visualizing-data.html#cb8-4"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-18-1.png" width="984" /></p>
<div class="puzzle">
<p>We can already see some species groupings between bill length and bill depth, flipper length, and body mass. When plotting, it will be important to keep in mind that differentiating species might be important.</p>
</div>
<p>Do you see those groupings? We should explore how some of this data is structured by species!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="the-basics-of-visualizing-data.html#cb9-1"></a><span class="co"># Let&#39;s explore how some of this data is structured by species</span></span>
<span id="cb9-2"><a href="the-basics-of-visualizing-data.html#cb9-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins,               <span class="co"># Data</span></span>
<span id="cb9-3"><a href="the-basics-of-visualizing-data.html#cb9-3"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm,        <span class="co"># Your X-value</span></span>
<span id="cb9-4"><a href="the-basics-of-visualizing-data.html#cb9-4"></a>           <span class="dt">y =</span> bill_depth_mm,         <span class="co"># Your Y-value</span></span>
<span id="cb9-5"><a href="the-basics-of-visualizing-data.html#cb9-5"></a>           <span class="dt">col =</span> species)) <span class="op">+</span><span class="st">          </span><span class="co"># Aesthetics</span></span>
<span id="cb9-6"><a href="the-basics-of-visualizing-data.html#cb9-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Point</span></span>
<span id="cb9-7"><a href="the-basics-of-visualizing-data.html#cb9-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st">        </span><span class="co"># Linear regression</span></span>
<span id="cb9-8"><a href="the-basics-of-visualizing-data.html#cb9-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Relationship between bill length and depth</span><span class="ch">\n</span><span class="st">for different penguin species&quot;</span>, <span class="co"># Title</span></span>
<span id="cb9-9"><a href="the-basics-of-visualizing-data.html#cb9-9"></a>       <span class="dt">x =</span> <span class="st">&quot;Bill length (mm)&quot;</span>, <span class="co"># X-axis title</span></span>
<span id="cb9-10"><a href="the-basics-of-visualizing-data.html#cb9-10"></a>       <span class="dt">y =</span> <span class="st">&quot;Bill depth (mm)&quot;</span>, <span class="co"># Y-axis title</span></span>
<span id="cb9-11"><a href="the-basics-of-visualizing-data.html#cb9-11"></a>       <span class="dt">col =</span> <span class="st">&quot;Species&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># Colour data point by species (also creates legend)</span></span>
<span id="cb9-12"><a href="the-basics-of-visualizing-data.html#cb9-12"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co"># Apply a clean theme</span></span>
<span id="cb9-13"><a href="the-basics-of-visualizing-data.html#cb9-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb9-14"><a href="the-basics-of-visualizing-data.html#cb9-14"></a>      <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>))</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-19-1.png" width="864" /></p>
<div class="puzzle">
<p>By differentiating species, we can see that there is a pretty consistent relationship between bill length and depth across species (similar slopes), but that the ranges of these variables is different (the groupings are clearly shown by the colours). Adelie penguins tend to have smaller bill length but fairly large bill depth, while the inverse is true for Gentoo penguins.</p>
</div>
</div>
<div id="working-through-layers" class="section level2">
<h2><span class="header-section-number">6.4</span> Working through the layers</h2>
<p>As we have discussed, a graphic is made of different layers, combined together to visually communicate information in our data. Let us build a <code>ggplot</code> graphic step by step by adding one layer at a time.</p>
<p><code>ggplot2</code> code is easier to read if each line represents a new element. This style is generally favoured for <code>ggplot2</code> code in the R community. This means that as you add each layer, you should start a new line.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="images/gglayers.png" alt="Image adapted from [The Grammar of Graphics](https://www.springer.com/gp/book/9780387245447)."  />
<p class="caption">
Figure 6.4: Image adapted from <a href="https://www.springer.com/gp/book/9780387245447">The Grammar of Graphics</a>.
</p>
</div>
<div id="data-layer" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Data layer</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="the-basics-of-visualizing-data.html#cb10-1"></a><span class="co"># Layer 1: Data</span></span>
<span id="cb10-2"><a href="the-basics-of-visualizing-data.html#cb10-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-22-1.png" width="576" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="the-basics-of-visualizing-data.html#cb11-1"></a><span class="co"># Without any other information, your data will not be</span></span>
<span id="cb11-2"><a href="the-basics-of-visualizing-data.html#cb11-2"></a><span class="co"># visualised.</span></span></code></pre></div>
</div>
<div id="aesthetics-layer" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Aesthetics layer</h3>
<p>In <code>ggplot2</code>, aesthetics are a group of parameters that specify what and
how data is displayed. Here, we are telling <code>R</code> to plot <code>bill_length_mm</code> on the <code>x</code> axis and <code>bill_depth_mm</code> on the <code>y</code> axis. We have not yet told <code>R</code> <em>how</em> we want to represent the data though, so our data will not yet be plotted.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="the-basics-of-visualizing-data.html#cb12-1"></a><span class="co"># Next layer: aesthetics.  Here, we tell R to plot length</span></span>
<span id="cb12-2"><a href="the-basics-of-visualizing-data.html#cb12-2"></a><span class="co"># on the x axis, and depth on the y axis but we still</span></span>
<span id="cb12-3"><a href="the-basics-of-visualizing-data.html#cb12-3"></a><span class="co"># haven&#39;t told R how we want these data to be</span></span>
<span id="cb12-4"><a href="the-basics-of-visualizing-data.html#cb12-4"></a><span class="co"># represented...</span></span>
<span id="cb12-5"><a href="the-basics-of-visualizing-data.html#cb12-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> bill_depth_mm))</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="the-basics-of-visualizing-data.html#cb13-1"></a><span class="co"># See? Our variables are now assigned to the x and y axes,</span></span>
<span id="cb13-2"><a href="the-basics-of-visualizing-data.html#cb13-2"></a><span class="co"># but nothing is plotted yet.</span></span></code></pre></div>
</div>
<div id="geometric-layer" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Geometric layer</h3>
<p>Geometric objects, or <code>geoms</code>, determine the visual representation of your data. We can begin by plotting our data points as a scatter plot, to see how bill depth and bill length relate to each other.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="the-basics-of-visualizing-data.html#cb14-1"></a><span class="co"># Next layer(s): geometric object(s)</span></span>
<span id="cb14-2"><a href="the-basics-of-visualizing-data.html#cb14-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, </span>
<span id="cb14-3"><a href="the-basics-of-visualizing-data.html#cb14-3"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, </span>
<span id="cb14-4"><a href="the-basics-of-visualizing-data.html#cb14-4"></a>           <span class="dt">y =</span> bill_depth_mm)) <span class="op">+</span><span class="st"> </span><span class="co"># Use the plus sign to add each additional layer</span></span>
<span id="cb14-5"><a href="the-basics-of-visualizing-data.html#cb14-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="co"># The geom layer determines what style of plot we are using.</span></span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-24-1.png" width="576" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="the-basics-of-visualizing-data.html#cb15-1"></a>               <span class="co"># geom_point() plots the data as points!</span></span></code></pre></div>
<p>Note that you can add several <code>geoms</code> in one plot. For example, we could add a line on this plot to show a threshold value, or add a linear regression. For now, let us keep it simple!</p>
</div>
<div id="facets-coordinates-and-themes" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Facets, coordinates, and themes</h3>
<p>Now that the dataset is plotted, we can customize the plot to clarify the message, or to add more information. Facets are a popular way of dividing a plot into several windows according to some category in the data, to visually differentiate groupings. We can explore this plot differently if we use <code>facet_wrap()</code> to create separate “facets” according to our species groupings:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="the-basics-of-visualizing-data.html#cb16-1"></a><span class="co"># Next layer(s): customizations!  Facets split a plot into</span></span>
<span id="cb16-2"><a href="the-basics-of-visualizing-data.html#cb16-2"></a><span class="co"># separate windows according to some category in the data.</span></span>
<span id="cb16-3"><a href="the-basics-of-visualizing-data.html#cb16-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> bill_depth_mm)) <span class="op">+</span></span>
<span id="cb16-4"><a href="the-basics-of-visualizing-data.html#cb16-4"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species))  <span class="co"># This splits the plot into three windows: one per species</span></span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-25-1.png" width="576" /></p>
<div class="explanation">
<p>Note: You could also use <code>facet_grid()</code> if you wanted to facet according to two variables.</p>
</div>
<p>We can also adjust the scale of our axes in the plot itself, rather than transforming the data. Let us assume we are interested in looking at the relationship between the bill measurements on a <span class="math inline">\(log_{10}\)</span> scale.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="the-basics-of-visualizing-data.html#cb17-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> bill_depth_mm)) <span class="op">+</span></span>
<span id="cb17-2"><a href="the-basics-of-visualizing-data.html#cb17-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() geom_point()</span></span>
<span id="cb17-3"><a href="the-basics-of-visualizing-data.html#cb17-3"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() +</span></span>
<span id="cb17-4"><a href="the-basics-of-visualizing-data.html#cb17-4"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() facet_wrap(vars(species))</span></span>
<span id="cb17-5"><a href="the-basics-of-visualizing-data.html#cb17-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() +</span></span>
<span id="cb17-6"><a href="the-basics-of-visualizing-data.html#cb17-6"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() #</span></span>
<span id="cb17-7"><a href="the-basics-of-visualizing-data.html#cb17-7"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() this</span></span>
<span id="cb17-8"><a href="the-basics-of-visualizing-data.html#cb17-8"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() transforms</span></span>
<span id="cb17-9"><a href="the-basics-of-visualizing-data.html#cb17-9"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() the</span></span>
<span id="cb17-10"><a href="the-basics-of-visualizing-data.html#cb17-10"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() axes&#39;</span></span>
<span id="cb17-11"><a href="the-basics-of-visualizing-data.html#cb17-11"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() coordinates</span></span>
<span id="cb17-12"><a href="the-basics-of-visualizing-data.html#cb17-12"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() using</span></span>
<span id="cb17-13"><a href="the-basics-of-visualizing-data.html#cb17-13"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="co"># this transforms the axes&#39; coordinates using log10() log10()</span></span>
<span id="cb17-14"><a href="the-basics-of-visualizing-data.html#cb17-14"></a><span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log10&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log10&quot;</span>)</span></code></pre></div>
<p>As a final touch, we can also customize the plot’s theme, which includes its background, grid lines, and other visual characteristics of the plot. Let us assume we do not like the default grey background from ggplot2 (we would not be alone in this!). We can use <code>theme_bw()</code> to produce a more visually appealing plot. We will discuss themes in Chapter <a href="theme.html#theme">11</a>!</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="the-basics-of-visualizing-data.html#cb18-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> bill_depth_mm)) <span class="op">+</span></span>
<span id="cb18-2"><a href="the-basics-of-visualizing-data.html#cb18-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(species)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log10&quot;</span>,</span>
<span id="cb18-3"><a href="the-basics-of-visualizing-data.html#cb18-3"></a>    <span class="dt">y =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot y</span></span>
<span id="cb18-4"><a href="the-basics-of-visualizing-data.html#cb18-4"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot =</span></span>
<span id="cb18-5"><a href="the-basics-of-visualizing-data.html#cb18-5"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot &quot;log10&quot;)</span></span>
<span id="cb18-6"><a href="the-basics-of-visualizing-data.html#cb18-6"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot +</span></span>
<span id="cb18-7"><a href="the-basics-of-visualizing-data.html#cb18-7"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot #</span></span>
<span id="cb18-8"><a href="the-basics-of-visualizing-data.html#cb18-8"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot this</span></span>
<span id="cb18-9"><a href="the-basics-of-visualizing-data.html#cb18-9"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot uses</span></span>
<span id="cb18-10"><a href="the-basics-of-visualizing-data.html#cb18-10"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot a</span></span>
<span id="cb18-11"><a href="the-basics-of-visualizing-data.html#cb18-11"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot nicer</span></span>
<span id="cb18-12"><a href="the-basics-of-visualizing-data.html#cb18-12"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot theme</span></span>
<span id="cb18-13"><a href="the-basics-of-visualizing-data.html#cb18-13"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot for</span></span>
<span id="cb18-14"><a href="the-basics-of-visualizing-data.html#cb18-14"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot our</span></span>
<span id="cb18-15"><a href="the-basics-of-visualizing-data.html#cb18-15"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot final</span></span>
<span id="cb18-16"><a href="the-basics-of-visualizing-data.html#cb18-16"></a><span class="st">    </span>y =<span class="st"> &quot;log10&quot;</span><span class="er">)</span> <span class="op">+</span><span class="st"> </span><span class="co"># this uses a nicer theme for our final plot plot</span></span>
<span id="cb18-17"><a href="the-basics-of-visualizing-data.html#cb18-17"></a><span class="kw">theme_bw</span>()</span></code></pre></div>
</div>
</div>
<div id="challenge-1" class="section level2">
<h2><span class="header-section-number">6.5</span> Challenge 1</h2>
<p>Now it’s time to try to build your own plot! Make a ggplot to answer the following questions:</p>
<p><strong>1.</strong> Is there a relationship between <strong>bill length</strong> &amp; <strong>flipper length</strong>?</p>
<p><strong>2.</strong> Does <em>bill length</em> increase with flipper <em>length</em>?</p>
<p>Here are some parameters to consider when addressing this question:</p>
<table>
<thead>
<tr class="header">
<th align="center">data</th>
<th align="center">geom</th>
<th align="center">x value</th>
<th align="center">y value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">penguins</td>
<td align="center">geom_point</td>
<td align="center">bill_length_mm</td>
<td align="center">flipper_length_mm</td>
</tr>
</tbody>
</table>
<hr />
<div id="challenge-1-solution" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Challenge 1: Solution</h3>
<p>Let’s create a scatter plot with bill length on the x-axis and flipper length on the y-axis, to visualize the relationship between these two variables.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="the-basics-of-visualizing-data.html#cb19-1"></a><span class="co"># Make a scatter plot to visualize the variables</span></span>
<span id="cb19-2"><a href="the-basics-of-visualizing-data.html#cb19-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> flipper_length_mm)) <span class="op">+</span></span>
<span id="cb19-3"><a href="the-basics-of-visualizing-data.html#cb19-3"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>Aesthetics can either be in the <code>ggplot()</code> line, and will be inherited by every geom, or in the <code>geom_()</code> line to apply to that geom only. Here is an example.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="the-basics-of-visualizing-data.html#cb20-1"></a><span class="co"># Customize the points&#39; shape and colour</span></span>
<span id="cb20-2"><a href="the-basics-of-visualizing-data.html#cb20-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm, <span class="dt">y =</span> flipper_length_mm)) <span class="op">+</span></span>
<span id="cb20-3"><a href="the-basics-of-visualizing-data.html#cb20-3"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="explanation">
<p>Colour, alpha (transparency), shape, and size commands can be set outside of <code>aes()</code> values, and will be static, not data-dependent. Here, blue is not conveying any information in the data - it is just a choice we have made to make a prettier plot.</p>
</div>
<div class="puzzle">
<p>This plot does appear to show a positive relationship between bill length and flipper length across all the measured individuals in the dataset. So, penguins with longer bills tend to have longer flippers too. We can keep digging into this relationship by building on this plot!</p>
</div>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-palmerpenguins">
<p>Horst, Allison Marie, Alison Presmanes Hill, and Kristen B Gorman. 2020. <em>Palmerpenguins: Palmer Archipelago (Antarctica) Penguin Data</em>. <a href="https://doi.org/10.5281/zenodo.3960218">https://doi.org/10.5281/zenodo.3960218</a>.</p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="grammar-of-graphics-gg-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aesthetics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
