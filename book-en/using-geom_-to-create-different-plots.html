<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Using geom_*() to create different plots | Workshop 3: Introduction to ggplot2</title>
  <meta name="description" content="Introduction to ggplot2" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Using geom_*() to create different plots | Workshop 3: Introduction to ggplot2" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Introduction to ggplot2" />
  <meta name="github-repo" content="qcbsRworkshops/workshop03" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Using geom_*() to create different plots | Workshop 3: Introduction to ggplot2" />
  
  <meta name="twitter:description" content="Introduction to ggplot2" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="using-facets-to-split-up-your-plot.html"/>
<link rel="next" href="arrange-plots-patchwork.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Introduction to <code>ggplot2</code></b></span></li>
<li class="chapter" data-level="1" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>1</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="2" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>2</b> Learning objectives</a><ul>
<li class="chapter" data-level="2.1" data-path="learning-objectives.html"><a href="learning-objectives.html#workshop-outline"><i class="fa fa-check"></i><b>2.1</b> Workshop outline</a></li>
</ul></li>
<li class="part"><span><b>Visualization in science</b></span></li>
<li class="chapter" data-level="3" data-path="why-do-we-visualize-data.html"><a href="why-do-we-visualize-data.html"><i class="fa fa-check"></i><b>3</b> Why do we visualize data?</a></li>
<li class="chapter" data-level="4" data-path="why-use-r.html"><a href="why-use-r.html"><i class="fa fa-check"></i><b>4</b> Why use <code>R</code>?</a><ul>
<li class="chapter" data-level="4.1" data-path="why-use-r.html"><a href="why-use-r.html#reproducibility"><i class="fa fa-check"></i><b>4.1</b> Reproducibility</a></li>
<li class="chapter" data-level="4.2" data-path="why-use-r.html"><a href="why-use-r.html#powerful-features"><i class="fa fa-check"></i><b>4.2</b> Powerful features</a></li>
</ul></li>
<li class="part"><span><b><code>ggplot2</code> mechanics: the basics</b></span></li>
<li class="chapter" data-level="5" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html"><i class="fa fa-check"></i><b>5</b> Grammar of Graphics (GG) basics</a><ul>
<li class="chapter" data-level="5.1" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#what-is-the-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1</b> What is the Grammar of Graphics?</a></li>
<li class="chapter" data-level="5.2" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#gg-layers"><i class="fa fa-check"></i><b>5.2</b> Grammar of Graphics layers</a><ul>
<li class="chapter" data-level="5.2.1" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#a-breakdown-of-common-layers"><i class="fa fa-check"></i><b>5.2.1</b> A breakdown of common layers</a></li>
<li class="chapter" data-level="5.2.2" data-path="grammar-of-graphics-gg-basics.html"><a href="grammar-of-graphics-gg-basics.html#putting-these-layers-together"><i class="fa fa-check"></i><b>5.2.2</b> Putting these layers together</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html"><i class="fa fa-check"></i><b>6</b> The basics of visualizing data</a><ul>
<li class="chapter" data-level="6.1" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#todays-dataset-palmerpenguins"><i class="fa fa-check"></i><b>6.1</b> Today’s dataset: <code>palmerpenguins</code></a></li>
<li class="chapter" data-level="6.2" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#asking-questions"><i class="fa fa-check"></i><b>6.2</b> Asking questions</a></li>
<li class="chapter" data-level="6.3" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#exploring-data-structure"><i class="fa fa-check"></i><b>6.3</b> Exploring data structure</a></li>
<li class="chapter" data-level="6.4" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#working-through-layers"><i class="fa fa-check"></i><b>6.4</b> Working through the layers</a><ul>
<li class="chapter" data-level="6.4.1" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#data-layer"><i class="fa fa-check"></i><b>6.4.1</b> Data layer</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#aesthetics-layer"><i class="fa fa-check"></i><b>6.4.2</b> Aesthetics layer</a></li>
<li class="chapter" data-level="6.4.3" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#geometric-layer"><i class="fa fa-check"></i><b>6.4.3</b> Geometric layer</a></li>
<li class="chapter" data-level="6.4.4" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#facets-coordinates-and-themes"><i class="fa fa-check"></i><b>6.4.4</b> Facets, coordinates, and themes</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#challenge-1"><i class="fa fa-check"></i><b>6.5</b> Challenge 1</a><ul>
<li class="chapter" data-level="6.5.1" data-path="the-basics-of-visualizing-data.html"><a href="the-basics-of-visualizing-data.html#challenge-1-solution"><i class="fa fa-check"></i><b>6.5.1</b> Challenge 1: Solution</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Aesthetic mapping</b></span></li>
<li class="chapter" data-level="7" data-path="aesthetics.html"><a href="aesthetics.html"><i class="fa fa-check"></i><b>7</b> Aesthetics</a></li>
<li class="chapter" data-level="8" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html"><i class="fa fa-check"></i><b>8</b> Colours: make your points talk</a><ul>
<li class="chapter" data-level="8.1" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#using-aes-use-to-change-colour"><i class="fa fa-check"></i><b>8.1</b> Using <code>aes()</code> use to change colour</a></li>
<li class="chapter" data-level="8.2" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#manual-colour-change"><i class="fa fa-check"></i><b>8.2</b> Manual colour change</a></li>
<li class="chapter" data-level="8.3" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#gradients"><i class="fa fa-check"></i><b>8.3</b> Gradients</a></li>
<li class="chapter" data-level="8.4" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#use-a-new-colour-palette"><i class="fa fa-check"></i><b>8.4</b> Use a new colour palette</a></li>
<li class="chapter" data-level="8.5" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#colourblind-friendly-palettes"><i class="fa fa-check"></i><b>8.5</b> Colourblind-friendly palettes</a><ul>
<li class="chapter" data-level="8.5.1" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#example-for-grouped-data"><i class="fa fa-check"></i><b>8.5.1</b> Example for grouped data</a></li>
<li class="chapter" data-level="8.5.2" data-path="colours-make-your-points-talk.html"><a href="colours-make-your-points-talk.html#example-for-continuous-data"><i class="fa fa-check"></i><b>8.5.2</b> Example for continuous data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html"><i class="fa fa-check"></i><b>9</b> Changing <code>shape</code>, <code>size</code> and <code>alpha</code></a><ul>
<li class="chapter" data-level="9.1" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2"><i class="fa fa-check"></i><b>9.1</b> Challenge 2</a><ul>
<li class="chapter" data-level="9.1.1" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-mtcars"><i class="fa fa-check"></i><b>9.1.1</b> Challenge 2: Solution (<code>mtcars</code>)</a></li>
<li class="chapter" data-level="9.1.2" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-co2"><i class="fa fa-check"></i><b>9.1.2</b> Challenge 2: Solution (<code>CO2</code>)</a></li>
<li class="chapter" data-level="9.1.3" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-msleep"><i class="fa fa-check"></i><b>9.1.3</b> Challenge 2: Solution (<code>msleep</code>)</a></li>
<li class="chapter" data-level="9.1.4" data-path="changing-shape-size-and-alpha.html"><a href="changing-shape-size-and-alpha.html#challenge-2-solution-toothgrowth"><i class="fa fa-check"></i><b>9.1.4</b> Challenge 2: Solution (<code>ToothGrowth</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="changing-the-scale-of-the-axes.html"><a href="changing-the-scale-of-the-axes.html"><i class="fa fa-check"></i><b>10</b> Changing the scale of the axes</a></li>
<li class="part"><span><b>Fine-tuning your plots</b></span></li>
<li class="chapter" data-level="11" data-path="theme.html"><a href="theme.html"><i class="fa fa-check"></i><b>11</b> Using <code>theme()</code> to make it look good!</a><ul>
<li class="chapter" data-level="11.1" data-path="theme.html"><a href="theme.html#introduction-to-themes"><i class="fa fa-check"></i><b>11.1</b> Introduction to themes</a><ul>
<li class="chapter" data-level="11.1.1" data-path="theme.html"><a href="theme.html#default-grey"><i class="fa fa-check"></i><b>11.1.1</b> Default: Grey</a></li>
<li class="chapter" data-level="11.1.2" data-path="theme.html"><a href="theme.html#theme-classic"><i class="fa fa-check"></i><b>11.1.2</b> Theme Classic</a></li>
<li class="chapter" data-level="11.1.3" data-path="theme.html"><a href="theme.html#theme-minimal"><i class="fa fa-check"></i><b>11.1.3</b> Theme Minimal</a></li>
<li class="chapter" data-level="11.1.4" data-path="theme.html"><a href="theme.html#setting-the-theme-across-all-plots"><i class="fa fa-check"></i><b>11.1.4</b> Setting the theme across all plots</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="theme.html"><a href="theme.html#elements-of-a-theme"><i class="fa fa-check"></i><b>11.2</b> Elements of a theme</a></li>
<li class="chapter" data-level="11.3" data-path="theme.html"><a href="theme.html#building-your-own-theme"><i class="fa fa-check"></i><b>11.3</b> Building your own theme</a></li>
<li class="chapter" data-level="11.4" data-path="theme.html"><a href="theme.html#more-themes"><i class="fa fa-check"></i><b>11.4</b> More themes</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html"><i class="fa fa-check"></i><b>12</b> Using facets to split up your plot</a><ul>
<li class="chapter" data-level="12.1" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#facetting-by-one-variable"><i class="fa fa-check"></i><b>12.1</b> Facetting by one variable</a></li>
<li class="chapter" data-level="12.2" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#facetting-by-two-variables"><i class="fa fa-check"></i><b>12.2</b> Facetting by two variables</a></li>
<li class="chapter" data-level="12.3" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#title-and-axes-components-size-colour-and-face"><i class="fa fa-check"></i><b>12.3</b> Title and axes components: size, colour and face</a></li>
<li class="chapter" data-level="12.4" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#challenge-3"><i class="fa fa-check"></i><b>12.4</b> Challenge 3</a><ul>
<li class="chapter" data-level="12.4.1" data-path="using-facets-to-split-up-your-plot.html"><a href="using-facets-to-split-up-your-plot.html#challenge-3-solution"><i class="fa fa-check"></i><b>12.4.1</b> Challenge 3: Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html"><i class="fa fa-check"></i><b>13</b> Using <code>geom_*()</code> to create different plots</a><ul>
<li class="chapter" data-level="13.1" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#histograms-geom_histogram"><i class="fa fa-check"></i><b>13.1</b> Histograms: <code>geom_histogram()</code></a></li>
<li class="chapter" data-level="13.2" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#scatterplot-and-linear-fit-geom_point-and-geom_smooth"><i class="fa fa-check"></i><b>13.2</b> Scatterplot and linear-fit: <code>geom_point()</code> and <code>geom_smooth()</code></a></li>
<li class="chapter" data-level="13.3" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#boxplot-geom_boxplot"><i class="fa fa-check"></i><b>13.3</b> Boxplot: <code>geom_boxplot()</code></a></li>
<li class="chapter" data-level="13.4" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#annotated-boxplot-geom_boxplot-and-geom_signif"><i class="fa fa-check"></i><b>13.4</b> Annotated boxplot: <code>geom_boxplot()</code> and <code>geom_signif()</code></a></li>
<li class="chapter" data-level="13.5" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#violin-plot-geom_violin"><i class="fa fa-check"></i><b>13.5</b> Violin plot: <code>geom_violin()</code></a></li>
<li class="chapter" data-level="13.6" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#summarise-y-values-stat_summary"><i class="fa fa-check"></i><b>13.6</b> Summarise <code>y</code> values: <code>stat_summary()</code></a></li>
<li class="chapter" data-level="13.7" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#representing-maps-geom_map"><i class="fa fa-check"></i><b>13.7</b> Representing maps: <code>geom_map()</code></a></li>
<li class="chapter" data-level="13.8" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#density-plots-geom_density"><i class="fa fa-check"></i><b>13.8</b> Density plots: <code>geom_density()</code></a></li>
<li class="chapter" data-level="13.9" data-path="using-geom_-to-create-different-plots.html"><a href="using-geom_-to-create-different-plots.html#dendogram-ggdendrogram"><i class="fa fa-check"></i><b>13.9</b> Dendogram: <code>ggdendrogram()</code></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="arrange-plots-patchwork.html"><a href="arrange-plots-patchwork.html"><i class="fa fa-check"></i><b>14</b> Arrange plots: <code>patchwork</code></a></li>
<li class="chapter" data-level="15" data-path="challenge-4.html"><a href="challenge-4.html"><i class="fa fa-check"></i><b>15</b> Challenge 4</a><ul>
<li class="chapter" data-level="15.1" data-path="challenge-4.html"><a href="challenge-4.html#challenge-4-solution-example-1"><i class="fa fa-check"></i><b>15.1</b> Challenge 4: Solution example 1</a></li>
<li class="chapter" data-level="15.2" data-path="challenge-4.html"><a href="challenge-4.html#challenge-4-solution-example-2"><i class="fa fa-check"></i><b>15.2</b> Challenge 4: Solution example 2</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="miscellaneous-interactive-plots-using-plotly.html"><a href="miscellaneous-interactive-plots-using-plotly.html"><i class="fa fa-check"></i><b>16</b> Miscellaneous: interactive plots using <code>plotly()</code></a></li>
<li class="part"><span><b>Saving your plots</b></span></li>
<li class="chapter" data-level="17" data-path="saving-your-plots-in-code.html"><a href="saving-your-plots-in-code.html"><i class="fa fa-check"></i><b>17</b> Saving your plots in code</a></li>
<li class="part"><span><b>Conclusion</b></span></li>
<li class="chapter" data-level="18" data-path="concluding-remarks.html"><a href="concluding-remarks.html"><i class="fa fa-check"></i><b>18</b> Concluding remarks</a></li>
<li class="chapter" data-level="19" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>19</b> Additional resources</a><ul>
<li class="chapter" data-level="19.1" data-path="additional-resources.html"><a href="additional-resources.html#reference-documents"><i class="fa fa-check"></i><b>19.1</b> Reference documents</a></li>
<li class="chapter" data-level="19.2" data-path="additional-resources.html"><a href="additional-resources.html#books"><i class="fa fa-check"></i><b>19.2</b> Books</a></li>
<li class="chapter" data-level="19.3" data-path="additional-resources.html"><a href="additional-resources.html#inspiration-and-guides"><i class="fa fa-check"></i><b>19.3</b> Inspiration and guides</a></li>
<li class="chapter" data-level="19.4" data-path="additional-resources.html"><a href="additional-resources.html#lecture-notes"><i class="fa fa-check"></i><b>19.4</b> Lecture notes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 3: Introduction to <code>ggplot2</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="using-geom_-to-create-different-plots" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Using <code>geom_*()</code> to create different plots</h1>
<p>Multiple geoms can be used together in a single plot! The order determines how they overlap.</p>
<p><img src="images/plots_in_various_contexts.png" style="display: block; margin: auto;" /></p>
<p>This is a blank plot, before we add any <code>geom_*</code> to represent variables in the dataset.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="using-geom_-to-create-different-plots.html#cb65-1"></a><span class="kw">ggplot</span>(penguins)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<div id="histograms-geom_histogram" class="section level2">
<h2><span class="header-section-number">13.1</span> Histograms: <code>geom_histogram()</code></h2>
<p>A <strong>histogram</strong> is an accurate graphical representation of the distribution of numeric data. There is only one aesthetic required: the <code>x</code> variable.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="using-geom_-to-create-different-plots.html#cb66-1"></a><span class="kw">ggplot</span>(penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb66-2"><a href="using-geom_-to-create-different-plots.html#cb66-2"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Histogram of penguin bill length &quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-83-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="scatterplot-and-linear-fit-geom_point-and-geom_smooth" class="section level2">
<h2><span class="header-section-number">13.2</span> Scatterplot and linear-fit: <code>geom_point()</code> and <code>geom_smooth()</code></h2>
<p>A scatter plot is a great way to visualize data points for two variables. Two aesthetics are required in <code>geom_point()</code>: the <code>x</code> and <code>y</code> variables.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="using-geom_-to-create-different-plots.html#cb67-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Scatterplot&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>It can, however, be difficult to discern any potential relationship in a scatter plot. You can use <code>geom_smooth()</code> to fit a line through your data with a variety of methods. Here, we will add a linear fit to the scatter plot.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="using-geom_-to-create-different-plots.html#cb68-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm) <span class="op">+</span></span>
<span id="cb68-2"><a href="using-geom_-to-create-different-plots.html#cb68-2"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Linear Regression&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
<div id="boxplot-geom_boxplot" class="section level2">
<h2><span class="header-section-number">13.3</span> Boxplot: <code>geom_boxplot()</code></h2>
<p>Boxplots are a popular way to plot the distribution of data across some grouping variable, like species. You can specify this grouping variable in <code>aes()</code> using <code>group =</code>, or the aesthetics used to represent the data (<code>fill =</code>, <code>col =</code>, <code>shape =</code>) to generate the boxplot.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="using-geom_-to-create-different-plots.html#cb69-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, </span>
<span id="cb69-2"><a href="using-geom_-to-create-different-plots.html#cb69-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> species, </span>
<span id="cb69-3"><a href="using-geom_-to-create-different-plots.html#cb69-3"></a>           <span class="dt">y =</span> bill_length_mm,</span>
<span id="cb69-4"><a href="using-geom_-to-create-different-plots.html#cb69-4"></a>           <span class="dt">fill =</span> species)) <span class="op">+</span><span class="st"> </span><span class="co"># specify species as a grouping variable</span></span>
<span id="cb69-5"><a href="using-geom_-to-create-different-plots.html#cb69-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb69-6"><a href="using-geom_-to-create-different-plots.html#cb69-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-86-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="explanation">
<p>Though boxplots are very popular to summarise data, someone looking at your plot may not intuitively grasp how this summary works and what it might be hiding. Using boxplots well requires an understanding of their anatomy, as seen below. More on the pitfalls of boxplots <a href="https://www.data-to-viz.com/caveat/boxplot.html">here</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-87"></span>
<img src="images/boxplot_explain.png" alt="Anatomy of a boxplot by [Denise Coleman](https://www.leansigmacorporation.com/box-plot-with-minitab/)."  />
<p class="caption">
Figure 13.1: Anatomy of a boxplot by <a href="https://www.leansigmacorporation.com/box-plot-with-minitab/">Denise Coleman</a>.
</p>
</div>
</div>
</div>
<div id="annotated-boxplot-geom_boxplot-and-geom_signif" class="section level2">
<h2><span class="header-section-number">13.4</span> Annotated boxplot: <code>geom_boxplot()</code> and <code>geom_signif()</code></h2>
<p>To help boxplots speak for themselves, we can add annotations with <code>geom_signif()</code>. The function <code>geom_signif()</code> calculates the significance of a difference between groups and adds the annotation to the plot in a single line of code.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="using-geom_-to-create-different-plots.html#cb70-1"></a><span class="kw">library</span>(ggsignif)</span>
<span id="cb70-2"><a href="using-geom_-to-create-different-plots.html#cb70-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, </span>
<span id="cb70-3"><a href="using-geom_-to-create-different-plots.html#cb70-3"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> species, </span>
<span id="cb70-4"><a href="using-geom_-to-create-different-plots.html#cb70-4"></a>           <span class="dt">y=</span> bill_length_mm,</span>
<span id="cb70-5"><a href="using-geom_-to-create-different-plots.html#cb70-5"></a>           <span class="dt">fill =</span> species)) <span class="op">+</span></span>
<span id="cb70-6"><a href="using-geom_-to-create-different-plots.html#cb70-6"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb70-7"><a href="using-geom_-to-create-different-plots.html#cb70-7"></a><span class="st">  </span><span class="kw">geom_signif</span>(</span>
<span id="cb70-8"><a href="using-geom_-to-create-different-plots.html#cb70-8"></a>    <span class="co"># which groups should be compared?</span></span>
<span id="cb70-9"><a href="using-geom_-to-create-different-plots.html#cb70-9"></a>    <span class="dt">comparisons =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;Adelie&quot;</span>, <span class="st">&quot;Gentoo&quot;</span>)), </span>
<span id="cb70-10"><a href="using-geom_-to-create-different-plots.html#cb70-10"></a>    <span class="dt">map_signif_level=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-88-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="violin-plot-geom_violin" class="section level2">
<h2><span class="header-section-number">13.5</span> Violin plot: <code>geom_violin()</code></h2>
<p>Like boxplots, violin plots visualise the distribution of a numeric variable for one or several groups. However, a violin’s shape represents the distribution of points that is obscured in a boxplot’s summarisation, allowing for a more accurate representation of the data (<a href="https://www.data-to-viz.com/graph/violin.html">Data-to-Viz)</a>).</p>
<div class="explanation">
<p>Let us compare a boxplot and a violin plot on some generated data. Notice how the violin plot <em>shows</em> us the range <strong>and</strong> the variability in our data, while the boxplot cannot communicate these two things as intuitively.</p>
<div class="split">
<div class="split-left">
<p><img src="book-en_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
<div class="split-right">
<p><img src="book-en_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
</div>
</div>
</div>
<p>We can make a violin plot with our <code>penguins</code> data:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="using-geom_-to-create-different-plots.html#cb71-1"></a>violin &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> penguins, </span>
<span id="cb71-2"><a href="using-geom_-to-create-different-plots.html#cb71-2"></a>                 <span class="kw">aes</span>(<span class="dt">x =</span> species, </span>
<span id="cb71-3"><a href="using-geom_-to-create-different-plots.html#cb71-3"></a>                     <span class="dt">y =</span> bill_length_mm)) <span class="op">+</span></span>
<span id="cb71-4"><a href="using-geom_-to-create-different-plots.html#cb71-4"></a><span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">trim =</span> <span class="ot">FALSE</span>, <span class="co"># do not trim the violins&#39; tips if there are outliers</span></span>
<span id="cb71-5"><a href="using-geom_-to-create-different-plots.html#cb71-5"></a>              <span class="dt">fill =</span> <span class="st">&quot;grey70&quot;</span>, <span class="co"># set all the violins to grey</span></span>
<span id="cb71-6"><a href="using-geom_-to-create-different-plots.html#cb71-6"></a>              <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># transparency of the fill colour</span></span>
<span id="cb71-7"><a href="using-geom_-to-create-different-plots.html#cb71-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Violin plot&quot;</span>)</span>
<span id="cb71-8"><a href="using-geom_-to-create-different-plots.html#cb71-8"></a>violin</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-91-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Although we have a good idea of how the data is distributed, we can enhance the plot by visualising some summary statistics and the data points. Let us plot a boxplot and the data points <em>on top</em> of our violin plot with <code>geom_violin()</code> + <code>geom_boxplot()</code> + <code>geom_jitter()</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="using-geom_-to-create-different-plots.html#cb72-1"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points violin</span></span>
<span id="cb72-2"><a href="using-geom_-to-create-different-plots.html#cb72-2"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points +</span></span>
<span id="cb72-3"><a href="using-geom_-to-create-different-plots.html#cb72-3"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points #</span></span>
<span id="cb72-4"><a href="using-geom_-to-create-different-plots.html#cb72-4"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points this</span></span>
<span id="cb72-5"><a href="using-geom_-to-create-different-plots.html#cb72-5"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points geom</span></span>
<span id="cb72-6"><a href="using-geom_-to-create-different-plots.html#cb72-6"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points plots</span></span>
<span id="cb72-7"><a href="using-geom_-to-create-different-plots.html#cb72-7"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points the</span></span>
<span id="cb72-8"><a href="using-geom_-to-create-different-plots.html#cb72-8"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points data</span></span>
<span id="cb72-9"><a href="using-geom_-to-create-different-plots.html#cb72-9"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points points</span></span>
<span id="cb72-10"><a href="using-geom_-to-create-different-plots.html#cb72-10"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points with</span></span>
<span id="cb72-11"><a href="using-geom_-to-create-different-plots.html#cb72-11"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points some</span></span>
<span id="cb72-12"><a href="using-geom_-to-create-different-plots.html#cb72-12"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points additional</span></span>
<span id="cb72-13"><a href="using-geom_-to-create-different-plots.html#cb72-13"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points (horizontal)</span></span>
<span id="cb72-14"><a href="using-geom_-to-create-different-plots.html#cb72-14"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points noise</span></span>
<span id="cb72-15"><a href="using-geom_-to-create-different-plots.html#cb72-15"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points to</span></span>
<span id="cb72-16"><a href="using-geom_-to-create-different-plots.html#cb72-16"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points see</span></span>
<span id="cb72-17"><a href="using-geom_-to-create-different-plots.html#cb72-17"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points overlapping</span></span>
<span id="cb72-18"><a href="using-geom_-to-create-different-plots.html#cb72-18"></a>violin <span class="op">+</span><span class="st"> </span><span class="co"># this geom plots the data points with some additional (horizontal) noise  to see overlapping points points</span></span>
<span id="cb72-19"><a href="using-geom_-to-create-different-plots.html#cb72-19"></a><span class="kw">geom_jitter</span>(<span class="dt">shape =</span> <span class="dv">16</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="fl">0.2</span>), <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb72-20"><a href="using-geom_-to-create-different-plots.html#cb72-20"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-92-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="summarise-y-values-stat_summary" class="section level2">
<h2><span class="header-section-number">13.6</span> Summarise <code>y</code> values: <code>stat_summary()</code></h2>
<p>Adding summary statistics to your plot can help to highlight the key message in your plot. The function <code>stat_summary()</code> can run the summary statistic of your choice using the argument <code>fun =</code>, and add it to your plot according to the <code>geom =</code> you have set in the function.</p>
<p>For example, if we wanted to plot the median of the number of cylinders (<code>cyl</code>) in the <code>mtcars</code> dataset, we would use <code>stat_summary()</code> in the following way:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="using-geom_-to-create-different-plots.html#cb73-1"></a><span class="co"># plot the median of the number of cylinders</span></span>
<span id="cb73-2"><a href="using-geom_-to-create-different-plots.html#cb73-2"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> mpg)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;median&quot;</span>,</span>
<span id="cb73-3"><a href="using-geom_-to-create-different-plots.html#cb73-3"></a>    <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Medians&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>Though the median is a helpful summary statistics, it does not inform us about the uncertainty behind it. If we wanted to instead plot the mean of each group with bootstrapped confidence intervals, we could just switch the <code>fun.y =</code> argument:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="using-geom_-to-create-different-plots.html#cb74-1"></a><span class="co"># plot the mean of each group with bootstrapped confidence</span></span>
<span id="cb74-2"><a href="using-geom_-to-create-different-plots.html#cb74-2"></a><span class="co"># intervals</span></span>
<span id="cb74-3"><a href="using-geom_-to-create-different-plots.html#cb74-3"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(cyl, mpg)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb74-4"><a href="using-geom_-to-create-different-plots.html#cb74-4"></a>    <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Means and confidence intervals&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Computation failed in `stat_summary()`:
## The `Hmisc` package is required.</code></pre>
<p><img src="book-en_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p>For more summary statistics, see <code>geom_errorbar()</code>, <code>geom_pointrange()</code>, <code>geom_linerange()</code>, <code>geom_crossbar()</code>.</p>
</div>
<div id="representing-maps-geom_map" class="section level2">
<h2><span class="header-section-number">13.7</span> Representing maps: <code>geom_map()</code></h2>
<p>We will map the arrests per 100,000 residents for murder in each of the 50 US states in 1973 from the <code>USArrests</code> dataset with <code>geom_map()</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="using-geom_-to-create-different-plots.html#cb76-1"></a><span class="co"># load maps library</span></span>
<span id="cb76-2"><a href="using-geom_-to-create-different-plots.html#cb76-2"></a><span class="kw">library</span>(maps)</span>
<span id="cb76-3"><a href="using-geom_-to-create-different-plots.html#cb76-3"></a>states_map &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>) <span class="co"># get a state-level map of the US</span></span>
<span id="cb76-4"><a href="using-geom_-to-create-different-plots.html#cb76-4"></a></span>
<span id="cb76-5"><a href="using-geom_-to-create-different-plots.html#cb76-5"></a><span class="co"># State name is set as rownames. Let&#39;s make a new column for these</span></span>
<span id="cb76-6"><a href="using-geom_-to-create-different-plots.html#cb76-6"></a><span class="co"># that matches the column of state names in our states_map</span></span>
<span id="cb76-7"><a href="using-geom_-to-create-different-plots.html#cb76-7"></a>USArrests<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">tolower</span>(<span class="kw">rownames</span>(USArrests))</span>
<span id="cb76-8"><a href="using-geom_-to-create-different-plots.html#cb76-8"></a></span>
<span id="cb76-9"><a href="using-geom_-to-create-different-plots.html#cb76-9"></a><span class="co"># Build our map</span></span>
<span id="cb76-10"><a href="using-geom_-to-create-different-plots.html#cb76-10"></a><span class="kw">ggplot</span>(USArrests, </span>
<span id="cb76-11"><a href="using-geom_-to-create-different-plots.html#cb76-11"></a>       <span class="kw">aes</span>(<span class="dt">map_id =</span> region)) <span class="op">+</span><span class="st"> </span><span class="co"># the variable name to link our map and dataframe</span></span>
<span id="cb76-12"><a href="using-geom_-to-create-different-plots.html#cb76-12"></a><span class="st">  </span><span class="kw">geom_map</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Murder), <span class="co"># variable we want to represent with an aesthetic</span></span>
<span id="cb76-13"><a href="using-geom_-to-create-different-plots.html#cb76-13"></a>           <span class="dt">map =</span> states_map) <span class="op">+</span><span class="st"> </span><span class="co"># data frame that contains coordinates</span></span>
<span id="cb76-14"><a href="using-geom_-to-create-different-plots.html#cb76-14"></a><span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> states_map<span class="op">$</span>long, </span>
<span id="cb76-15"><a href="using-geom_-to-create-different-plots.html#cb76-15"></a>                <span class="dt">y =</span> states_map<span class="op">$</span>lat) <span class="op">+</span></span>
<span id="cb76-16"><a href="using-geom_-to-create-different-plots.html#cb76-16"></a><span class="st">  </span><span class="kw">coord_map</span>() <span class="op">+</span><span class="st">  </span><span class="co"># projection </span></span>
<span id="cb76-17"><a href="using-geom_-to-create-different-plots.html#cb76-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="co"># remove axis labels</span></span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
<div id="density-plots-geom_density" class="section level2">
<h2><span class="header-section-number">13.8</span> Density plots: <code>geom_density()</code></h2>
<p>A density plot shows the distribution of a numerical variable and it takes only set of numeric values as input.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="using-geom_-to-create-different-plots.html#cb77-1"></a>(peng.dens &lt;-<span class="st"> </span><span class="kw">ggplot</span>(penguins, <span class="kw">aes</span>(<span class="dt">x =</span> bill_length_mm)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>())</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="using-geom_-to-create-different-plots.html#cb78-1"></a>(cars.dens &lt;-<span class="st"> </span><span class="kw">ggplot</span>(cars, <span class="kw">aes</span>(<span class="dt">x =</span> dist)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>())</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
<div id="dendogram-ggdendrogram" class="section level2">
<h2><span class="header-section-number">13.9</span> Dendogram: <code>ggdendrogram()</code></h2>
<p>Which US states have similar arrest rates?</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="using-geom_-to-create-different-plots.html#cb79-1"></a><span class="kw">library</span>(ggdendro)</span>
<span id="cb79-2"><a href="using-geom_-to-create-different-plots.html#cb79-2"></a></span>
<span id="cb79-3"><a href="using-geom_-to-create-different-plots.html#cb79-3"></a>USArrests.short &lt;-<span class="st"> </span>USArrests[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]  <span class="co"># take a small sample for simplicity</span></span>
<span id="cb79-4"><a href="using-geom_-to-create-different-plots.html#cb79-4"></a>hc &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(USArrests.short), <span class="st">&quot;average&quot;</span>)  <span class="co"># cluster by average distance (UPGMA)</span></span></code></pre></div>
<pre><code>## Warning in dist(USArrests.short): NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="using-geom_-to-create-different-plots.html#cb81-1"></a><span class="co"># plot the clustering dendrogram</span></span>
<span id="cb81-2"><a href="using-geom_-to-create-different-plots.html#cb81-2"></a><span class="kw">ggdendrogram</span>(hc, <span class="dt">rotate =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="using-facets-to-split-up-your-plot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arrange-plots-patchwork.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
